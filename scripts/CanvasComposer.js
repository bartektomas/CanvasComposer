"use strict";function IDGenerator(){this.length=8,this.timestamp=+new Date;var t=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};this.generate=function(){for(var e=this.timestamp.toString(),n=e.split("").reverse(),a="",o=0;o<this.length;++o){var i=t(0,n.length-1);a+=n[i]}return a}}function findObj(t){for(var e=0;e<canvas._objects.length;e++){if(canvas._objects[e].id===t)return canvas._objects[e];console.log(canvas._objects[e])}}function getThumbnails(t,e){var n="https://www.googleapis.com/youtube/v3/videos?id="+t+"&part=snippet&key=AIzaSyCjiWPLJdE-QbakmKin__3rDqOKLgKyCRY";$.getJSON(n,function(){console.log("success")}).done(function(t){console.log(t);var n;return n=""!=t.items[0].snippet.thumbnails.standard.url?t.items[0].snippet.thumbnails.standard.url:t.items[0].snippet.thumbnails["default"].url,e(n)}).fail(function(t){console.log(t)})}function validateYouTubeUrl(t){if(void 0!=t||""!=t){var e=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/,n=t.match(e);return n&&11==n[2].length?n[2]:!1}}function bindEvents(t){t.on("selected",function(){console.log("selected"),$(".objectControl").addClass("active"),"i-text"===t.type||"clock"===t.type?($(".text-attr").show(),$(".basic-attr").hide()):($(".text-attr").hide(),$(".basic-attr").show()),$("#config").fadeIn("fast").promise().done(function(){$(this).fadeTo("fast",.9)}),instantMeta.log(t)}),canvas.on("before:selection:cleared",function(){console.log("deselected"),$(".objectControl").removeClass("active"),$("#config").fadeOut("fast"),instantMeta.clean()}),t.on("scaling",function(){console.log("scaling"),instantMeta.log(t)}),t.on("moving",function(){console.log("moving"),instantMeta.log(t)}),t.on("rotating",function(){console.log("rotating"),instantMeta.log(t)}),t.on("changed",function(){console.log("Exited"),instantMeta.log(t)})}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};fabric.Object.prototype.link="",fabric.Video=fabric.util.createClass(fabric.Image,{type:"video",initialize:function(t,e){if(e||(e={}),this.callSuper("initialize",e),console.log("inittt"),"object"===("undefined"==typeof t?"undefined":_typeof(t)))console.log("this is an object"),this._initElement(t,e),this._initConfig(e);else{var n=document.createElement("video");n.loop=!0,n.controls=!0,console.log(n),console.log(t),n.innerHTML='<source src="'+t+'">',console.log(n),this._initElement(n,e),this._initConfig(e),n.play(),fabric.util.requestAnimFrame(function a(){canvas.renderAll(),fabric.util.requestAnimFrame(a)})}},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{media:{video:this.media.video,youtubeId:this.media.youtubeId},link:this.link})},_render:function(t){this.callSuper("_render",t)}}),fabric.Video.fromURL=function(t,e,n,a){fabric.util.loadImage(t,function(o){n&&n(new fabric.Video(o,{media:{video:t,youtubeId:e}},a))},null,a&&a.crossOrigin)},fabric.Video.fromObject=function(t,e){var n=new fabric.Video(t.media.video,{width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY,top:t.top,left:t.left,media:{video:t.media.video,youtubeId:t.media.youtubeId}});return bindEvents(n),canvas.setActiveObject(n),n},fabric.Slider=fabric.util.createClass(fabric.Rect,{type:"slider",initialize:function(t){t||(t={}),this.callSuper("initialize",t),console.log("inittt")},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{id:this.id,fill:this.fill,slides:this.slides,link:this.link,pattern:this.pattern,patternSourceCanvas:this.patternSourceCanvas,filename:this.filename})},_render:function(t){this.callSuper("_render",t)}}),fabric.Slider.fromArray=function(t,e,n){var a=t[0].src,o=a.split(".").pop();if(o.match(/^(gif|png|jpg|jpeg|tiff|svg)$/))new fabric.Image.fromURL(a,function(a){var o=new fabric.StaticCanvas;console.log(a),a.setHeight(o.height),a.setWidth(o.width),o.setBackgroundImage(a),o.renderAll(),console.log(o.getElement());var i=new fabric.Pattern({source:o.getElement(),repeat:"no-repeat"});e&&e(new fabric.Slider({fill:i,width:a.width,height:a.height,left:n.left,top:n.top,slides:t,link:n.link,id:generator.generate(),pattern:i,patternSourceCanvas:o,filename:t[0].filename}))},null,n&&n.crossOrigin);else if(o.match(/^(mp4|avi|ogg|ogv|webm)$/)){var i,r,s=new fabric.StaticCanvas,l=new fabric.Video(t[0].src,{media:{video:t[0].src}}),c=l.getElement(),d=new fabric.Pattern({source:s.getElement(),repeat:"no-repeat"});s.add(l),s.renderAll(),c.onloadeddata=function(){i=this.videoWidth,r=this.videoHeight,l.setWidth(s.width),l.setHeight(s.height),l.center(),l.setCoords(),canvas.renderAll()},fabric.util.requestAnimFrame(function f(){s.renderAll(),fabric.util.requestAnimFrame(f)}),e&&e(new fabric.Slider({fill:d,width:s.width,height:s.height,left:n.left,top:n.top,slides:t,link:n.link,id:generator.generate(),pattern:d,patternSourceCanvas:s,filename:t[0].filename}))}else console.log("不支援此檔案格式，請重試")},fabric.Slider.fromObject=function(t,e,n){var a=t.slides[0].src,o=a.split(".").pop();if(o.match(/^(gif|png|jpg|jpeg|tiff|svg)$/))new fabric.Image.fromURL(a,function(n){var a=new fabric.StaticCanvas;console.log(n),n.setHeight(a.height),n.setWidth(a.width),a.setBackgroundImage(n),a.renderAll(),console.log(a.getElement());var o=new fabric.Pattern({source:a.getElement(),repeat:"no-repeat"});e&&e(new fabric.Slider({width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY,top:t.top,left:t.left,slides:t.slides,link:t.link,fill:o,id:t.id,pattern:o,patternSourceCanvas:a,filename:t.slides[0].filename}))},null,n&&n.crossOrigin);else if(o.match(/^(mp4|avi|ogg|ogv|webm)$/)){var i,r,s=new fabric.StaticCanvas,l=new fabric.Video(a,{media:{video:a}}),c=l.getElement(),d=new fabric.Pattern({source:s.getElement(),repeat:"no-repeat"});s.add(l),s.renderAll(),c.onloadeddata=function(){i=this.videoWidth,r=this.videoHeight,l.setWidth(s.width),l.setHeight(s.height),l.center(),l.setCoords(),canvas.renderAll()},fabric.util.requestAnimFrame(function f(){s.renderAll(),fabric.util.requestAnimFrame(f)}),e&&e(new fabric.Slider({width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY,top:t.top,left:t.left,slides:t.slides,fill:d,id:t.id,link:t.link,pattern:d,patternSourceCanvas:s,filename:t.slides[0].filename}))}else console.log("不支援此檔案格式，請重試")},fabric.Slider.async=!0;var generator=new IDGenerator;fabric.Clock=fabric.util.createClass(fabric.Text,{type:"clock",initialize:function(t,e){e||(e={}),this.callSuper("initialize",t,e),console.log("inittt")},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{})},_render:function(t){this.callSuper("_render",t)}});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t},canvas,grid,threshold,initRadius=100,CanvasComposer={init:function(t,e){console.log(this),this.loadView(),$(document).on("files-loaded",function(){"object"===("undefined"==typeof t?"undefined":_typeof(t))?CanvasComposer.initCanvas.initWithData(t,e):"new"===t&&CanvasComposer.initCanvas.init(),CanvasComposer.toolBar(),CanvasComposer.Contextmenu(),CanvasComposer.HotKeys(),CanvasComposer.attrPanels(),CanvasComposer.canvasPanels(),CanvasComposer.MediaLibrary(),CanvasComposer.inboundLinks()})},Save:{toObj:function(){var t=JSON.stringify(canvas);console.log(t)},toPng:function(){var t=canvas.toDataURL("png");window.open(t)},toSvg:function(){var t=canvas.toSVG({suppressPreamble:!0});console.log(t)}}};CanvasComposer.loadView=function(){var t=$("#canvaseditor"),e=function(t,e){return{load:function(n,a,o){var i=[];t.each(n,function(e,n){var o=t.get(n).success(function(e){t(a).append(e)});i.push(o)}),t.when.apply(null,i).done(function(){t(e).trigger(o)})}}}(jQuery,document);$(function(){var n=["templates/sidebar.html","templates/artboard.html","templates/config.html","templates/contextmenu.html","templates/library.html","templates/inbounds.html","templates/canvassettings.html"];e.load(n,t,"files-loaded")})},CanvasComposer.initCanvas={init:function(){function t(t){return Math.round(t/grid)*grid}function e(t){if(t.target){var e=t.target,n=!1,a={left:e.left,right:e.left+e.width*e.scaleX,top:e.top,bottom:e.top+e.height*e.scaleY},o={left:0,top:0,right:canvas.getWidth(),bottom:canvas.getHeight()},i={};return a.left<o.left&&(n=!0,i.left=o.left),a.top<o.top&&(n=!0,i.top=o.top),a.right>o.right&&(n=!0,i.left=a.left-(a.right-o.right)),a.bottom>o.bottom&&(n=!0,i.top=a.top-(a.bottom-o.bottom)),n&&(e.set(i),canvas.renderAll()),t}}function n(e){var n=e.target,a=n.width*n.scaleX,o=n.height*n.scaleY,i={top:t(n.top),left:t(n.left),bottom:t(n.top+o),right:t(n.left+a)},r={top:Math.abs(i.top-n.top),left:Math.abs(i.left-n.left),bottom:Math.abs(i.bottom-n.top-o),right:Math.abs(i.right-n.left-a)};r.bottom<r.top?r.bottom>threshold?i.top=n.top:i.top=i.bottom-o:r.top>threshold&&(i.top=n.top),r.right<r.left?r.right>threshold?i.left=n.left:i.left=i.right-a:r.left>threshold&&(i.left=n.left),n.set({top:i.top,left:i.left})}function a(e){var n=e.target,a=n.getWidth(),o=n.getHeight(),i={top:t(n.top),left:t(n.left),bottom:t(n.top+o),right:t(n.left+a)},r={top:Math.abs(i.top-n.top),left:Math.abs(i.left-n.left),bottom:Math.abs(i.bottom-n.top-o),right:Math.abs(i.right-n.left-a)},s={scaleX:n.scaleX,scaleY:n.scaleY,top:n.top,left:n.left};switch(n.__corner){case"tl":r.left<r.top&&r.left<threshold?(s.scaleX=(a-(i.left-n.left))/n.width,s.scaleY=s.scaleX/n.scaleX*n.scaleY,s.top=n.top+(o-n.height*s.scaleY),s.left=i.left):r.top<threshold&&(s.scaleY=(o-(i.top-n.top))/n.height,s.scaleX=s.scaleY/n.scaleY*n.scaleX,s.left=s.left+(a-n.width*s.scaleX),s.top=i.top);break;case"mt":r.top<threshold&&(s.scaleY=(o-(i.top-n.top))/n.height,s.top=i.top);break;case"tr":r.right<r.top&&r.right<threshold?(s.scaleX=(i.right-n.left)/n.width,s.scaleY=s.scaleX/n.scaleX*n.scaleY,s.top=n.top+(o-n.height*s.scaleY)):r.top<threshold&&(s.scaleY=(o-(i.top-n.top))/n.height,s.scaleX=s.scaleY/n.scaleY*n.scaleX,s.top=i.top);break;case"ml":r.left<threshold&&(s.scaleX=(a-(i.left-n.left))/n.width,s.left=i.left);break;case"mr":r.right<threshold&&(s.scaleX=(i.right-n.left)/n.width);break;case"bl":r.left<r.bottom&&r.left<threshold?(s.scaleX=(a-(i.left-n.left))/n.width,s.scaleY=s.scaleX/n.scaleX*n.scaleY,s.left=i.left):r.bottom<threshold&&(s.scaleY=(i.bottom-n.top)/n.height,s.scaleX=s.scaleY/n.scaleY*n.scaleX,s.left=s.left+(a-n.width*s.scaleX));break;case"mb":r.bottom<threshold&&(s.scaleY=(i.bottom-n.top)/n.height);break;case"br":r.right<r.bottom&&r.right<threshold?(s.scaleX=(i.right-n.left)/n.width,s.scaleY=s.scaleX/n.scaleX*n.scaleY):r.bottom<threshold&&(s.scaleY=(i.bottom-n.top)/n.height,s.scaleX=s.scaleY/n.scaleY*n.scaleX)}n.set(s)}canvas=new fabric.Canvas("c",{width:800,height:600}),grid=50,threshold=.2*grid,canvas.on("object:moving",n),canvas.on("object:scaling",a),canvas.on("object:moving",e),canvas.on("object:scaling",e)},initWithData:function(t,e){function n(t){return Math.round(t/grid)*grid}function a(t){if(t.target){var e=t.target,n=!1,a={left:e.left,right:e.left+e.width*e.scaleX,top:e.top,bottom:e.top+e.height*e.scaleY},o={left:0,top:0,right:canvas.getWidth(),bottom:canvas.getHeight()},i={};return a.left<o.left&&(n=!0,i.left=o.left),a.top<o.top&&(n=!0,i.top=o.top),a.right>o.right&&(n=!0,i.left=a.left-(a.right-o.right)),a.bottom>o.bottom&&(n=!0,i.top=a.top-(a.bottom-o.bottom)),n&&(e.set(i),canvas.renderAll()),t}}function o(t){var e=t.target,a=e.width*e.scaleX,o=e.height*e.scaleY,i={top:n(e.top),left:n(e.left),bottom:n(e.top+o),right:n(e.left+a)},r={top:Math.abs(i.top-e.top),left:Math.abs(i.left-e.left),bottom:Math.abs(i.bottom-e.top-o),right:Math.abs(i.right-e.left-a)};r.bottom<r.top?r.bottom>threshold?i.top=e.top:i.top=i.bottom-o:r.top>threshold&&(i.top=e.top),r.right<r.left?r.right>threshold?i.left=e.left:i.left=i.right-a:r.left>threshold&&(i.left=e.left),e.set({top:i.top,left:i.left})}function i(t){var e=t.target,a=e.getWidth(),o=e.getHeight(),i={top:n(e.top),left:n(e.left),bottom:n(e.top+o),right:n(e.left+a)},r={top:Math.abs(i.top-e.top),left:Math.abs(i.left-e.left),bottom:Math.abs(i.bottom-e.top-o),right:Math.abs(i.right-e.left-a)},s={scaleX:e.scaleX,scaleY:e.scaleY,top:e.top,left:e.left};switch(e.__corner){case"tl":r.left<r.top&&r.left<threshold?(s.scaleX=(a-(i.left-e.left))/e.width,s.scaleY=s.scaleX/e.scaleX*e.scaleY,s.top=e.top+(o-e.height*s.scaleY),s.left=i.left):r.top<threshold&&(s.scaleY=(o-(i.top-e.top))/e.height,s.scaleX=s.scaleY/e.scaleY*e.scaleX,s.left=s.left+(a-e.width*s.scaleX),s.top=i.top);break;case"mt":r.top<threshold&&(s.scaleY=(o-(i.top-e.top))/e.height,s.top=i.top);break;case"tr":r.right<r.top&&r.right<threshold?(s.scaleX=(i.right-e.left)/e.width,s.scaleY=s.scaleX/e.scaleX*e.scaleY,s.top=e.top+(o-e.height*s.scaleY)):r.top<threshold&&(s.scaleY=(o-(i.top-e.top))/e.height,s.scaleX=s.scaleY/e.scaleY*e.scaleX,s.top=i.top);break;case"ml":r.left<threshold&&(s.scaleX=(a-(i.left-e.left))/e.width,s.left=i.left);break;case"mr":r.right<threshold&&(s.scaleX=(i.right-e.left)/e.width);break;case"bl":r.left<r.bottom&&r.left<threshold?(s.scaleX=(a-(i.left-e.left))/e.width,s.scaleY=s.scaleX/e.scaleX*e.scaleY,s.left=i.left):r.bottom<threshold&&(s.scaleY=(i.bottom-e.top)/e.height,s.scaleX=s.scaleY/e.scaleY*e.scaleX,s.left=s.left+(a-e.width*s.scaleX));break;case"mb":r.bottom<threshold&&(s.scaleY=(i.bottom-e.top)/e.height);break;case"br":r.right<r.bottom&&r.right<threshold?(s.scaleX=(i.right-e.left)/e.width,s.scaleY=s.scaleX/e.scaleX*e.scaleY):r.bottom<threshold&&(s.scaleY=(i.bottom-e.top)/e.height,s.scaleX=s.scaleY/e.scaleY*e.scaleX)}e.set(s)}canvas=new fabric.Canvas("c",{width:e.width,height:e.height}),grid=50,threshold=.2*grid,canvas.on("object:moving",o),canvas.on("object:scaling",i),canvas.on("object:moving",a),canvas.on("object:scaling",a),CanvasComposer.Load.FromJSON(t,function(t){console.log(t)})},fit:function(){function t(){CanvasComposer.initCanvas.fit()}var e,n=document.getElementById("artboard"),a=document.getElementById("canvas");(function(){var t=(canvas.width/canvas.height,canvas.width/n.clientWidth),e=canvas.height/n.clientHeight;console.log("W:"+t),console.log("H:"+e);var o;t>=e?t>1?(t=n.clientWidth/canvas.width,o=t*t,console.log(t),o>1&&(o=1),a.style.transform="scale("+o+")",a.style.transformOrigin="25% 25%"):(o=1,a.style.transform="scale("+o+")",a.style.transformOrigin="25% 25%"):e>t&&(e>1?(e=n.clientHeight/canvas.height,o=e*e,console.log(e),o>1&&(o=1),a.style.transform="scale("+o+")",a.style.transformOrigin="45% 25%"):(o=1,a.style.transform="scale("+o+")",a.style.transformOrigin="25% 25%"))})();window.onresize=function(){clearTimeout(e),e=setTimeout(t,100)}}},CanvasComposer.canvasPanels=function(){$("#canvasWidth").on("change paste keyup",function(){canvas.setWidth($(this).val()),canvas.renderAll(),CanvasComposer.initCanvas.fit(),$(".sizeTag .tag.width span").html($(this).val())}),$("#canvasHeight").on("change paste keyup",function(){canvas.setHeight($(this).val()),canvas.renderAll(),CanvasComposer.initCanvas.fit(),$(".sizeTag .tag.height span").html($(this).val())}),$("#canvas-select").change(function(){var t=$("#canvas-select option:selected").attr("data-width"),e=$("#canvas-select option:selected").attr("data-height");$("#widthValue").val(t),$("#heightValue").val(e),canvas.setWidth(t),canvas.setHeight(e),canvas.renderAll(),CanvasComposer.initCanvas.fit(),$(".sizeTag .tag.width span").html(t),$(".sizeTag .tag.height span").html(e)}),$(".layoutpresets").on("click","a",function(){if(""!=$(this).attr("data-src")||void 0!=$(this).attr("data-src"))if($(this).parent().siblings().children("a").removeClass("active"),$(this).addClass("active"),canvas._objects.length>0){var t=confirm("讀取預設版型會移除目前畫面中的所有物件，是否確定讀取？");if(1!=t)return;CanvasComposer.Artboard.dispose(),CanvasComposer.Load.FromPresets($(this).attr("data-src"),function(t){console.log(t),$("#canvassetting").fadeOut("fast")})}else CanvasComposer.Load.FromPresets($(this).attr("data-src"),function(t){console.log(t),$("#canvassetting").fadeOut("fast")});else alert("Error loading preset.")})},CanvasComposer.toolBar=function(){var t={addRect:function(t){CanvasComposer.Artboard.addRect()},addCircle:function(t){CanvasComposer.Artboard.addCircle()},addText:function(t){CanvasComposer.Artboard.addText()},addClock:function(t){CanvasComposer.Artboard.Multimedia.clock()},addWeather:function(t){var e=$(this).siblings("ul");e.toggleClass("active")},lockAll:function(t){},disposeAll:function(t){CanvasComposer.Artboard.dispose()},artboardSettings:function(t){$("#canvassetting").fadeIn(),$(document).mouseup(function(t){var e=$(".canvasconfig-wrapper");e.is(t.target)||0!==e.has(t.target).length||e.parent().hide()})},saveState:function(t){CanvasComposer.Save.toSvg()}};$("a[data-action]").on("click",function(e){var n=$(this),a=n.data("action");e.preventDefault(),"function"==typeof t[a]&&t[a].call(this,e)}),$("a[data-action=addWeather]").siblings("ul").on("click","a",function(){var t=$("#weatherCity option:selected").val();console.log(t),CanvasComposer.Artboard.Multimedia.weather(t),$(this).parents("ul").removeClass("active")})},CanvasComposer.HotKeys=function(){var t={8:!1,91:!1,187:!1,189:!1,40:!1,38:!1,68:!1,17:!1,76:!1};$(document).keydown(function(e){if(e.keyCode in t)if(t[e.keyCode]=!0,t[8]&&t[91])e.preventDefault(),e.stopPropagation(),CanvasComposer.Artboard.removeObject(),t[8]=!1;else if(t[38]&&t[91]){e.preventDefault(),e.stopPropagation();var n=canvas.getActiveObject();n.bringToFront(),t[38]=!1}else if(t[187]&&t[91]){e.preventDefault(),e.stopPropagation();var n=canvas.getActiveObject();n.bringForward(),t[187]=!1}else if(t[189]&&t[91]){e.preventDefault(),e.stopPropagation();var n=canvas.getActiveObject();n.sendBackwards(),t[189]=!1}else if(t[40]&&t[91]){e.preventDefault(),e.stopPropagation();var n=canvas.getActiveObject();n.sendToBack(),t[40]=!1}else t[68]&&t[17]?(e.preventDefault(),e.stopPropagation(),CanvasComposer.Artboard.duplicateObject(),t[68]=!1):t[76]&&t[91]&&(e.preventDefault(),e.stopPropagation(),CanvasComposer.Artboard.lockObject(),t[76]=!1)}).keyup(function(e){e.keyCode in t&&(t[e.keyCode]=!1)})},CanvasComposer.Artboard={addRect:function(){var t=new fabric.Rect({left:canvas.getWidth()/2-initRadius/2,top:canvas.getHeight()/2-initRadius/2,fill:"#"+Math.floor(16777215*Math.random()).toString(16),width:initRadius,height:initRadius});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),t.perPixelTargetFind=!0,canvas.add(t),bindEvents(t),canvas.setActiveObject(t)},addCircle:function(){var t=new fabric.Circle({left:canvas.getWidth()/2-initRadius/2,top:canvas.getHeight()/2-initRadius/2,fill:"#"+Math.floor(16777215*Math.random()).toString(16),radius:initRadius/2});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),t.perPixelTargetFind=!0,canvas.add(t),bindEvents(t),canvas.setActiveObject(t)},addText:function(){var t=new fabric.IText("預設文字",{left:200,top:200,lockScalingX:!0,lockScalingY:!0,fontSize:"36"});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),canvas.add(t),bindEvents(t),canvas.setActiveObject(t)},addMedia:function(t){if(t.length>1){var e=t;CanvasComposer.Artboard.Multimedia.slider(e)}else if(1===t.length){var n=t[0].src.split(".").pop(),a=validateYouTubeUrl(t[0].src);if(0!=a){getThumbnails(a,function(t){console.log(t),CanvasComposer.Artboard.Multimedia.video(t,a)})}else n.match(/^(gif|png|jpg|jpeg|tiff|svg)$/)?CanvasComposer.Artboard.Multimedia.image(t[0].src):n.match(/^(mp4|avi|ogg|ogv|webm)$/)?CanvasComposer.Artboard.Multimedia.video(t[0].src):console.log("不支援此檔案格式，請重試")}},dispose:function(){for(var t=0;t<canvas._objects.length;t++)void 0!==canvas._objects[t]._element&&"video"===canvas._objects[t]._element.localName?canvas._objects[t].getElement().pause():console.log("error");canvas.clear()},duplicateObject:function(){var t=canvas.getActiveObject();canvas.add(t.clone()),canvas.renderAll()},lockObject:function(){var t=canvas.getActiveObject();t.lockMovementY===!0?(t.lockMovementY=!1,t.lockMovementX=!1,t.lockRotation=!1,t.lockScalingX=!1,t.lockScalingY=!1):(t.lockMovementY=!0,t.lockMovementX=!0,t.lockRotation=!0,t.lockScalingX=!0,t.lockScalingY=!0)},removeObject:function(){var t=canvas.getActiveObject();void 0!==t._element&&"video"===t._element.localName?(t.getElement().pause(),t.remove()):t.remove()},reset:function(){var t=canvas.getActiveObject();t.setScaleX("1"),t.setScaleY("1"),t.center(),t.setCoords(),canvas.renderAll(),instantMeta.log(t)}},CanvasComposer.Artboard.Multimedia={image:function(t){new fabric.Image.fromURL(t,function(t){t.set({left:canvas.getWidth()/2-t.width/2,top:canvas.getHeight()/2-t.height/2});var e=t.getWidth()/canvas.getWidth(),n=t.getHeight()/canvas.getHeight();if(e>=n){if(!(e>1))return;t.scaleToWidth(canvas.getWidth())}else{if(!(n>1))return;t.scaleToHeight(canvas.getHeight())}canvas.add(t),t.center(),t.setCoords(),t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t)})},video:function t(e,n){if(void 0!=n){console.log(e);var a=new fabric.Video.fromURL(e,n,function(t){t.set({left:canvas.getWidth()/2-t.width/2,top:canvas.getHeight()/2-t.height/2}),console.log(t.toObject()),a.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link,media:{video:this.video,youtubeId:n}})}}(a.toObject),canvas.add(t),t.center(),t.setCoords(),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t)})}else{console.log("match video");var o,i,t=new fabric.Video(e,{media:{video:e}}),r=t.getElement();canvas.add(t),console.log(r),console.log(t),r.onloadeddata=function(){o=this.videoWidth,i=this.videoHeight,t.setWidth(o),t.setHeight(i),t.center(),t.setCoords(),canvas.renderAll(),console.log(this),console.log(o),t.getElement().play(),t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{media:{video:e},link:this.link})}}(t.toObject),bindEvents(t),canvas.setActiveObject(t),fabric.util.requestAnimFrame(function n(){canvas.renderAll(),fabric.util.requestAnimFrame(n)})}}},slider:function(t){var e,n=0;new fabric.Slider.fromArray(t,function(t){function a(t,n,r){t++,t===n.slides.length&&(t=0);var s=n.slides[t].src.split(".").pop();if(s.match(/^(gif|png|jpg|jpeg|tiff|svg)$/))new fabric.Image.fromURL(n.slides[t].src,function(t){t.setHeight(o.height),t.setWidth(o.width);for(var e=0;e<o._objects.length;e++)void 0!==o._objects[e]._element&&"video"===o._objects[e]._element.localName?o._objects[e].getElement().pause():console.log("error");o.clear(),o.setBackgroundImage(t),o.renderAll(),i=new fabric.Pattern({source:o.getElement(),repeat:"no-repeat"}),n.setFill(i),canvas.renderAll()}),e=1e3*n.slides[t].continued,setTimeout(function(){a(t,n,r)},e);else if(s.match(/^(mp4|avi|ogg|ogv|webm)$/)){for(var l,c,d=new fabric.Video(n.slides[t].src,{media:{video:n.slides[t].src}}),f=d.getElement(),u=0;u<o._objects.length;u++)void 0!==o._objects[u]._element&&"video"===o._objects[u]._element.localName?o._objects[u].getElement().pause():console.log("error");o.clear(),o.add(d),console.log(o.getContext()),o.renderAll(),console.log(f),console.log(d),f.onloadeddata=function(){l=this.videoWidth,c=this.videoHeight,d.setWidth(o.width),d.setHeight(o.height),d.center(),d.setCoords(),canvas.renderAll()},fabric.util.requestAnimFrame(function h(){o.renderAll(),fabric.util.requestAnimFrame(h)}),e=1e3*n.slides[t].continued,setTimeout(function(){a(t,n,r)},e)}else console.log("不支援此檔案格式，請重試")}var o=t.patternSourceCanvas,i=t.pattern;canvas.add(t),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t),t.setCoords(),e=1e3*t.slides[0].continued;var r=t.id;setTimeout(function(){a(n,t,r)},e)},{left:150,top:100})},clock:function e(){Date.prototype.timeNow=function(){return(this.getHours()<10?"0":"")+(this.getHours()>12?this.getHours()-12:this.getHours())+":"+(this.getMinutes()<10?"0":"")+this.getMinutes()+":"+(this.getSeconds()<10?"0":"")+this.getSeconds()+(this.getHours()>12?"PM":"AM")};var e=new fabric.Clock((new Date).timeNow(),{fontSize:"36",fontFamily:"open-sans",fontWeight:400});e.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(e.toObject),canvas.add(e),bindEvents(e),canvas.setActiveObject(e),setInterval(function(){e.setText((new Date).timeNow()),canvas.renderAll()},1e3)},weather:function(t){Weather.translate(t,function(t){var e=t.conditionText,n=t.conditionImg,a=t.temp,o=t.city;t.country;console.log(e);new fabric.Image.fromURL("images/components/conditions/svg/"+n,function(t){t.scaleToWidth(60),t.set({left:0,top:30});var n=new fabric.Text(e,{left:70,top:50,fontSize:"18",fontFamily:"open-sans"}),i=new fabric.Text(a,{left:0,top:90,fontSize:"60",fontFamily:"open-sans",fontWeight:300}),r=new fabric.Text(o,{left:0,top:0,fontSize:"18",fontFamily:"open-sans"}),s=new fabric.Group([n,i,r,t],{left:150,top:100});canvas.add(s),bindEvents(s),canvas.setActiveObject(s)})})},iframe:function(){}},CanvasComposer.attrPanels=function(){function t(t){var e=window.getComputedStyle(t.target,null);t.dataTransfer.setData("text/plain",parseInt(e.getPropertyValue("left"),10)-t.clientX+","+(parseInt(e.getPropertyValue("top"),10)-t.clientY))}function e(t){return t.preventDefault(),!1}function n(t){console.log(t);var e=t.dataTransfer.getData("text/plain").split(","),n=document.getElementById("config");return n.style.left=t.clientX+parseInt(e[0],10)+"px",n.style.top=t.clientY+parseInt(e[1],10)+"px",console.log(n),t.preventDefault(),!1}var a=document.getElementById("config");a.addEventListener("dragstart",t,!1),document.body.addEventListener("dragover",e,!1),document.body.addEventListener("drop",n,!1),$(".objectControl").on("click","button",function(){var t=$(this).attr("class");switch(t){case"js-delete":CanvasComposer.Artboard.removeObject();break;case"js-reset":CanvasComposer.Artboard.reset()}}),$(".objectSize").on("change",function(){var t,e,n,a,o=canvas.getActiveObject();t=o.width,e=o.height,n=$("#objectWidth").val()/t,a=$("#objectHeight").val()/e,o.setScaleX(n),o.setScaleY(a),o.setCoords(),canvas.renderAll()}),$("#objectColor").spectrum({showInput:!0,className:"full-spectrum",showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxSelectionSize:10,preferredFormat:"hex",localStorageKey:"spectrum.demo",move:function(t){},show:function(){},beforeShow:function(){},hide:function(){},change:function(t){var e=canvas.getActiveObject();"i-text"===e.type?(e.setTextBackgroundColor(t),console.log(t)):e.setFill(t),canvas.renderAll(),$("#objectColor").spectrum("hide")},palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]}),$("#objectTextColor").spectrum({showInput:!0,className:"full-spectrum",showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxSelectionSize:10,preferredFormat:"hex",localStorageKey:"spectrum.demo",move:function(t){},show:function(){},beforeShow:function(){},hide:function(){},change:function(t){var e=canvas.getActiveObject();"i-text"===e.type&&e.setFill(t),canvas.renderAll(),$("#objectTextColor").spectrum("hide")},palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]}),$("#objectInput").on("keydown keyup paste change",function(){var t=canvas.getActiveObject();t.set("text",$(this).val()),t.setCoords(),canvas.renderAll()}),$("#objectFontFamily").on("change",function(){var t=$(this).val(),e=canvas.getActiveObject();e.setFontFamily(t),e.setCoords(),canvas.renderAll()}),$("#objectFontSize").on("change",function(){var t=$(this).val(),e=canvas.getActiveObject();e.setFontSize(t),e.setCoords(),canvas.renderAll()}),$("#linkValue").on("keydown keyup change",function(){var t=canvas.getActiveObject(),e=$(this).val();t.set("link",e)})},CanvasComposer.Contextmenu=function(){function t(t,e){var n=t.srcElement||t.target;if(n.classList.contains(e))return n;for(;n=n.parentNode;)if(n.classList&&n.classList.contains(e))return n;return!1}function e(t){var e=0,n=0;if(!t)var t=window.event;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:n}}function n(){a(),o(),i(),r()}function a(){document.addEventListener("contextmenu",function(e){f=t(e,C),f?(e.preventDefault(),s(),c(e)):(f=null,l())})}function o(){document.addEventListener("click",function(e){var n=t(e,y);if(n)e.preventDefault(),d(n);else{var a=e.which||e.button;1===a&&l()}})}function i(){window.onkeyup=function(t){27===t.keyCode&&l()}}function r(){window.onresize=function(t){l()}}function s(){1!==k&&(k=1,_.classList.add(w))}function l(){0!==k&&(k=0,_.classList.remove(w))}function c(t){u=e(t),h=u.x,g=u.y,p=_.offsetWidth+4,v=_.offsetHeight+4,b=window.innerWidth,m=window.innerHeight,p>b-h?_.style.left=b-p+"px":_.style.left=h+"px",v>m-g?_.style.top=m-v+"px":_.style.top=g+"px"}function d(t){var e=t.getAttribute("data-action"),n=canvas.getActiveObject();switch(e){case"delete":CanvasComposer.Artboard.removeObject();break;case"duplicate":CanvasComposer.Artboard.duplicateObject();break;case"layertop":n.bringToFront(),canvas.renderAll();break;case"layerup":n.bringForward(),canvas.renderAll();break;case"layerdown":n.sendBackwards(),canvas.renderAll();break;case"layerbottom":n.sendToBack();break;case"lock":
CanvasComposer.Artboard.lockObject()}l()}var f,u,h,g,p,v,b,m,y="context-menu__link",w="context-menu--active",C="task",_=document.querySelector("#context-menu"),k=(_.querySelectorAll(".context-menu__item"),0);n()},CanvasComposer.Load={FromPresets:function(t,e){$.getJSON(t,function(t){console.log("success")}).done(function(t){console.log("done"),console.log(t),canvas.loadFromJSON(t,canvas.renderAll.bind(canvas),function(t,e){if(console.log(t),console.log(e),canvas.renderAll(),"slider"===e.type){var n,a,o,i,r;!function(){var t=function s(t,e,n){t++,t===e.slides.length&&(t=0);var r=e.slides[t].src.split(".").pop();if(r.match(/^(gif|png|jpg|jpeg|tiff|svg)$/))new fabric.Image.fromURL(e.slides[t].src,function(t){t.setHeight(o.height),t.setWidth(o.width);for(var n=0;n<o._objects.length;n++)void 0!==o._objects[n]._element&&"video"===o._objects[n]._element.localName?o._objects[n].getElement().pause():console.log("error");o.clear(),o.setBackgroundImage(t),o.renderAll(),i=new fabric.Pattern({source:o.getElement(),repeat:"no-repeat"}),e.setFill(i),canvas.renderAll()}),a=1e3*e.slides[t].continued,setTimeout(function(){s(t,e,n)},a);else if(r.match(/^(mp4|avi|ogg|ogv|webm)$/)){for(var l,c,d=new fabric.Video(e.slides[t].src,{media:{video:e.slides[t].src}}),f=d.getElement(),u=0;u<o._objects.length;u++)void 0!==o._objects[u]._element&&"video"===o._objects[u]._element.localName?o._objects[u].getElement().pause():console.log("error");o.clear(),o.add(d),console.log(o.getContext()),o.renderAll(),console.log(f),console.log(d),f.onloadeddata=function(){l=this.videoWidth,c=this.videoHeight,d.setWidth(o.width),d.setHeight(o.height),d.center(),d.setCoords(),canvas.renderAll()},fabric.util.requestAnimFrame(function h(){o.renderAll(),fabric.util.requestAnimFrame(h)}),a=1e3*e.slides[t].continued,setTimeout(function(){s(t,e,n)},a)}else console.log("不支援此檔案格式，請重試")};n=0,o=e.patternSourceCanvas,i=e.pattern,a=1e3*e.slides[0].continued,r=e.id,setTimeout(function(){t(n,e,r)},a)}()}bindEvents(e)}),e&&e("Presets Loaded Successful.")}).fail(function(t){e&&e("Presets loading task Failed."+t)})},FromJSON:function(t){canvas.loadFromJSON(t,canvas.renderAll.bind(canvas),function(t,e){if(console.log(t),console.log(e),canvas.renderAll(),"slider"===e.type){var n,a,o,i,r;!function(){var t=function s(t,e,n){t++,t===e.slides.length&&(t=0);var r=e.slides[t].src.split(".").pop();if(r.match(/^(gif|png|jpg|jpeg|tiff|svg)$/))new fabric.Image.fromURL(e.slides[t].src,function(t){t.setHeight(o.height),t.setWidth(o.width);for(var n=0;n<o._objects.length;n++)void 0!==o._objects[n]._element&&"video"===o._objects[n]._element.localName?o._objects[n].getElement().pause():console.log("error");o.clear(),o.setBackgroundImage(t),o.renderAll(),i=new fabric.Pattern({source:o.getElement(),repeat:"no-repeat"}),e.setFill(i),canvas.renderAll()}),a=1e3*e.slides[t].continued,setTimeout(function(){s(t,e,n)},a);else if(r.match(/^(mp4|avi|ogg|ogv|webm)$/)){for(var l,c,d=new fabric.Video(e.slides[t].src,{media:{video:e.slides[t].src}}),f=d.getElement(),u=0;u<o._objects.length;u++)void 0!==o._objects[u]._element&&"video"===o._objects[u]._element.localName?o._objects[u].getElement().pause():console.log("error");o.clear(),o.add(d),console.log(o.getContext()),o.renderAll(),console.log(f),console.log(d),f.onloadeddata=function(){l=this.videoWidth,c=this.videoHeight,d.setWidth(o.width),d.setHeight(o.height),d.center(),d.setCoords(),canvas.renderAll()},fabric.util.requestAnimFrame(function h(){o.renderAll(),fabric.util.requestAnimFrame(h)}),a=1e3*e.slides[t].continued,setTimeout(function(){s(t,e,n)},a)}else console.log("不支援此檔案格式，請重試")};n=0,o=e.patternSourceCanvas,i=e.pattern,a=1e3*e.slides[0].continued,r=e.id,setTimeout(function(){t(n,e,r)},a)}()}bindEvents(e)})}},CanvasComposer.MediaLibrary=function(){function t(t){if(t.length>1){console.log("an array");var e=canvas.getActiveObject();null==e?alert("未選取任何物件"):(void 0!==e._element&&"video"===e._element.localName?(e.getElement().pause(),e.remove()):e.remove(),CanvasComposer.Artboard.addMedia(t)),$("#mediaLibrary").removeClass("active")}else if(1===t.length){console.log("single");var e=canvas.getActiveObject();null==e?alert("未選取任何物件"):(void 0!==e._element&&"video"===e._element.localName?(e.getElement().pause(),e.remove()):e.remove(),CanvasComposer.Artboard.addMedia(t)),$("#mediaLibrary").removeClass("active")}}$(".js-library").on("click",function(){$("#mediaLibrary").addClass("active");var t=canvas.getActiveObject();if("slider"===t.type){$("#mediaLibrary .selection").empty(),$("#mediaLibrary .resources a").removeClass("active");for(var e,n,a,o,i,r=$(".settings-container .selection"),s=0;s<t.slides.length;s++){e=t.slides[s].id,n=t.slides[s].src,a=t.slides[s].continued,o=t.slides[s].filename;var l="<li data-resourceid="+e+" data-src="+n+"><div class='controlgroup'><label>持續時間：</label><div class='controls'><div class='row'><div class='grid g-9-12'><div class='order'><div class='continued'><input type='number' value='"+a+"'></div></div></div><div class='grid g-3-12'><div class='thumbnail' style='background-image: url("+n+");' title='"+o+"'></div></div></div></div></div></li>";r.append(l),$("#mediaLibrary .resources li").each(function(){i=$(this).children("a").attr("data-resourceid"),e===i&&$(this).children("a").addClass("active")})}}else $("#mediaLibrary .selection").empty(),$("#mediaLibrary .resources a").removeClass("active")}),$("#mediaLibrary .js-close").on("click",function(){$("#mediaLibrary").removeClass("active")}),$("#mediaLibrary .resources").on("click","a",function(){var t,e,n,a,o=$(".settings-container .selection");e=$(this).attr("data-src"),t=$(this).attr("title"),a=$(this).attr("data-resourceid"),n="3";var i="<li data-resourceid="+a+" data-src="+e+"><div class='controlgroup'><label>持續時間：</label><div class='controls'><div class='row'><div class='grid g-9-12'><div class='order'><div class='continued'><input type='number' value='"+n+"'></div></div></div><div class='grid g-3-12'><div class='thumbnail' style='background-image: url("+e+");' title='"+t+"'></div></div></div></div></div></li>",r=$(this);r.hasClass("active")?o.children("li").each(function(){a===$(this).attr("data-resourceid")&&($(this).remove(),r.removeClass("active"))}):(o.append(i),r.addClass("active"))}),$(".js-sendToObj").on("click",function(){var e,n,a,o,i=[],r=$(".settings-container .selection");r.children("li").each(function(){e=$(this).attr("data-resourceid"),n=$(this).attr("data-src"),a=$(this).find("input").val(),o=$(this).find(".filename").html();var t={id:e,src:n,continued:a,filename:o};i.push(t),console.log(i)}),t(i)})},CanvasComposer.inboundLinks=function(){var t=$("#inboundlist");$(".js-inbounds").on("click",function(){t.addClass("active")}),$("#inboundlist a[data-rel]").on("click",function(){var e=$(this).data("rel"),n=canvas.getActiveObject();n.link=e,t.removeClass("active"),instantMeta.log(n)}),$("#inboundlist .js-close").on("click",function(){t.removeClass("active")})};var instantMeta={log:function(t){t=t.toObject();var e,n,a,o,i,r,s,l,c,d,f,u,h,g,p,v;switch(e=t.width*t.scaleX,n=t.height*t.scaleY,a=t.scaleX,o=t.scaleY,i=t.radius,r=t.left,s=t.top,l=t.angle,c=t.type,v=t.link,f="i-text"===t.type?t.textBackgroundColor:t.fill,u=t.fill,h=t.text,g=t.fontSize,p=t.fontFamily,c){case"image":d=t.src;break;case"video":d=t.media.video;break;case"slider":d="mixture"}$(".attributes-wrapper .type input").val(c),$(".attributes-wrapper .width input").val(e),$(".attributes-wrapper .height input").val(n),$(".attributes-wrapper .radius input").val(i),$(".attributes-wrapper .angle input").val(l),$(".attributes-wrapper .top input").val(s),$(".attributes-wrapper .left input").val(r),$(".attributes-wrapper .media input").val(d),$(".attributes-wrapper .scalex input").val(a),$(".attributes-wrapper .scaley input").val(o),$(".attributes-wrapper .text input").val(h),$(".attributes-wrapper .link input").val(v),$(".attributes-wrapper .fontsize select option[value="+g+"]").attr("selected",!0),$('.attributes-wrapper .fontfamily select option[value="'+p+'"]').attr("selected",!0),$("#objectColor").spectrum("set",f),$("#objectTextColor").spectrum("set",u)},clean:function(t){$(".attributes-wrapper input").val(""),$(".attributes-wrapper .mediaPreview").empty(),console.log("clean")}},Weather={translate:function(t,e){var n=t,a="https://query.yahooapis.com/v1/public/yql?q=select%20*%20from%20weather.forecast%20where%20woeid%20%3D%20"+n+"&format=json&callback=?";$.getJSON(a,function(t){console.log(t);var n=i[t.query.results.channel.item.condition.code.toString()],a=o[t.query.results.channel.item.condition.code.toString()],r=Math.round(5*(t.query.results.channel.item.condition.temp-32)/9)+"°C",s=t.query.results.channel.location.city,l=t.query.results.channel.location.country;e&&e({conditionText:n,conditionImg:a,temp:r,city:s,country:l})}).fail(function(t){console.log(t)});var o={0:"00.svg",1:"01.svg",2:"02.svg",3:"03.svg",4:"04.svg",5:"05.svg",6:"06.svg",7:"07.svg",8:"08.svg",9:"09.svg",10:"10.svg",11:"11.svg",12:"12.svg",13:"13.svg",14:"14.svg",15:"15.svg",16:"16.svg",17:"17.svg",18:"18.svg",19:"19.svg",20:"20.svg",21:"21.svg",22:"22.svg",23:"23.svg",24:"24.svg",25:"25.svg",26:"26.svg",27:"27.svg",28:"28.svg",29:"29.svg",30:"30.svg",31:"31.svg",32:"32.svg",33:"33.svg",34:"34.svg",35:"35.svg",36:"36.svg",37:"37.svg",38:"38.svg",39:"39.svg",40:"40.svg",41:"41.svg",42:"42.svg",43:"43.svg",44:"44.svg",45:"45.svg",46:"46.svg",47:"47.svg",3200:"na.svg"},i={0:"龍捲風",1:"熱帶風暴",2:"颶風",3:"強雷陣雨",4:"雷陣雨",5:"混合雨雪",6:"混合雨雪",7:"混合雨雪",8:"冰凍小雨",9:"細雨",10:"凍雨",11:"陣雨",12:"陣雨",13:"飄雪",14:"陣雪",15:"吹雪",16:"下雪",17:"冰雹",18:"雨雪",19:"多塵",20:"多霧",21:"陰霾",22:"多煙",23:"狂風大作",24:"有風",25:"冷",26:"多雲",27:"晴間多雲",28:"晴間多雲",29:"晴間多雲",30:"晴間多雲",31:"清晰的（夜）",32:"晴朗",33:"晴朗",34:"晴朗",35:"雨和冰雹",36:"炎熱",37:"雷陣雨",38:"零星雷陣雨",39:"零星雷陣雨",40:"零星雷陣雨",41:"大雪",42:"零星陣雪",43:"大雪",44:"多雲",45:"雷陣雨",46:"陣雪",47:"雷陣雨",3200:"資料錯誤"}}},Typekit;!function(t){var e,n={kitId:"daf4cqp",scriptTimeout:3e3,async:!0},a=t.documentElement,o=setTimeout(function(){a.className=a.className.replace(/\bwf-loading\b/g,"")+" wf-inactive"},n.scriptTimeout),i=t.createElement("script"),r=!1,s=t.getElementsByTagName("script")[0];a.className+=" wf-loading",i.src="https://use.typekit.net/"+n.kitId+".js",i.async=!0,i.onload=i.onreadystatechange=function(){if(e=this.readyState,!(r||e&&"complete"!=e&&"loaded"!=e)){r=!0,clearTimeout(o);try{Typekit.load(n)}catch(t){}}},s.parentNode.insertBefore(i,s)}(document);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(["jquery"],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t(require("jquery")):t(jQuery)}(function(t,e){function n(e,n,a,o){for(var i=[],r=0;r<e.length;r++){var s=e[r];if(s){var l=tinycolor(s),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(n,s)?" sp-thumb-active":"";var d=l.toString(o.preferredFormat||"rgb"),f=v?"background-color:"+l.toRgbString():"filter:"+l.toFilter();i.push('<span title="'+d+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+f+';" /></span>')}else{var u="sp-clear-display";i.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+u+'"></span>').attr("title",o.noColorSelectedText)).html())}}return"<div class='sp-cf "+a+"'>"+i.join("")+"</div>"}function a(){for(var t=0;t<g.length;t++)g[t]&&g[t].hide()}function o(e,n){var a=t.extend({},h,e);return a.callbacks={move:c(a.move,n),change:c(a.change,n),show:c(a.show,n),hide:c(a.hide,n),beforeShow:c(a.beforeShow,n)},a}function i(i,s){function c(){if(z.showPaletteOnly&&(z.showPalette=!0),Ft.text(z.showPaletteOnly?z.togglePaletteMoreText:z.togglePaletteLessText),z.palette){ht=z.palette.slice(0),gt=t.isArray(ht[0])?ht:[ht],pt={};for(var e=0;e<gt.length;e++)for(var n=0;n<gt[e].length;n++){var a=tinycolor(gt[e][n]).toRgbString();pt[a]=!0}}kt.toggleClass("sp-flat",V),kt.toggleClass("sp-input-disabled",!z.showInput),kt.toggleClass("sp-alpha-enabled",z.showAlpha),kt.toggleClass("sp-clear-enabled",Jt),kt.toggleClass("sp-buttons-disabled",!z.showButtons),kt.toggleClass("sp-palette-buttons-disabled",!z.togglePaletteOnly),kt.toggleClass("sp-palette-disabled",!z.showPalette),kt.toggleClass("sp-palette-only",z.showPaletteOnly),kt.toggleClass("sp-initial-disabled",!z.showInitial),kt.addClass(z.className).addClass(z.containerClassName),I()}function h(){function e(e){return e.data&&e.data.ignore?(M(t(e.target).closest(".sp-thumb-el").data("color")),P()):(M(t(e.target).closest(".sp-thumb-el").data("color")),P(),R(!0),z.hideAfterPaletteSelect&&E()),!1}if(p&&kt.find("*:not(input)").attr("unselectable","on"),c(),Nt&&Ct.after(Lt).hide(),Jt||Pt.hide(),V)Ct.after(kt).hide();else{var n="parent"===z.appendTo?Ct.parent():t(z.appendTo);1!==n.length&&(n=t("body")),n.append(kt)}y(),Wt.bind("click.spectrum touchstart.spectrum",function(e){_t||A(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(Ct.is(":disabled")||z.disabled===!0)&&B(),kt.click(l),Dt.change(j),Dt.bind("paste",function(){setTimeout(j,1)}),Dt.keydown(function(t){13==t.keyCode&&j()}),Xt.text(z.cancelText),Xt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),D(),E()}),Pt.attr("title",z.clearText),Pt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Kt=!0,P(),V&&R(!0)}),Ht.text(z.chooseText),Ht.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),p&&Dt.is(":focus")&&Dt.trigger("change"),X()&&(R(!0),E())}),Ft.text(z.showPaletteOnly?z.togglePaletteMoreText:z.togglePaletteLessText),Ft.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),z.showPaletteOnly=!z.showPaletteOnly,z.showPaletteOnly||V||kt.css("left","-="+(St.outerWidth(!0)+5)),c()}),d(Tt,function(t,e,n){ut=t/rt,Kt=!1,n.shiftKey&&(ut=Math.round(10*ut)/10),P()},S,x),d(At,function(t,e){ct=parseFloat(e/ot),Kt=!1,z.showAlpha||(ut=1),P()},S,x),d(xt,function(t,e,n){if(n.shiftKey){if(!yt){var a=dt*et,o=nt-ft*nt,i=Math.abs(t-a)>Math.abs(e-o);yt=i?"x":"y"}}else yt=null;var r=!yt||"x"===yt,s=!yt||"y"===yt;r&&(dt=parseFloat(t/et)),s&&(ft=parseFloat((nt-e)/nt)),Kt=!1,z.showAlpha||(ut=1),P()},S,x),qt?(M(qt),H(),Vt=z.preferredFormat||tinycolor(qt).format,w(qt)):H(),V&&$();var a=p?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Mt.delegate(".sp-thumb-el",a,e),Yt.delegate(".sp-thumb-el:nth-child(1)",a,{ignore:!0},e)}function y(){if(K&&window.localStorage){try{var e=window.localStorage[K].split(",#");e.length>1&&(delete window.localStorage[K],t.each(e,function(t,e){w(e)}))}catch(n){}try{vt=window.localStorage[K].split(";")}catch(n){}}}function w(e){if(U){var n=tinycolor(e).toRgbString();if(!pt[n]&&-1===t.inArray(n,vt))for(vt.push(n);vt.length>bt;)vt.shift();if(K&&window.localStorage)try{window.localStorage[K]=vt.join(";")}catch(a){}}}function C(){var t=[];if(z.showPalette)for(var e=0;e<vt.length;e++){var n=tinycolor(vt[e]).toRgbString();pt[n]||t.push(vt[e])}return t.reverse().slice(0,z.maxSelectionSize)}function _(){var e=Y(),a=t.map(gt,function(t,a){return n(t,e,"sp-palette-row sp-palette-row-"+a,z)});y(),vt&&a.push(n(C(),e,"sp-palette-row sp-palette-row-selection",z)),Mt.html(a.join(""))}function k(){if(z.showInitial){var t=zt,e=Y();Yt.html(n([t,e],e,"sp-palette-row-initial",z))}}function S(){(0>=nt||0>=et||0>=ot)&&I(),tt=!0,kt.addClass(mt),yt=null,Ct.trigger("dragstart.spectrum",[Y()])}function x(){tt=!1,kt.removeClass(mt),Ct.trigger("dragstop.spectrum",[Y()])}function j(){var t=Dt.val();if(null!==t&&""!==t||!Jt){var e=tinycolor(t);e.isValid()?(M(e),R(!0)):Dt.addClass("sp-validation-error")}else M(null),R(!0)}function A(){Z?E():$()}function $(){var e=t.Event("beforeShow.spectrum");return Z?void I():(Ct.trigger(e,[Y()]),void(G.beforeShow(Y())===!1||e.isDefaultPrevented()||(a(),Z=!0,t(wt).bind("keydown.spectrum",O),t(wt).bind("click.spectrum",T),t(window).bind("resize.spectrum",Q),Lt.addClass("sp-active"),kt.removeClass("sp-hidden"),I(),H(),zt=Y(),k(),G.show(zt),Ct.trigger("show.spectrum",[zt]))))}function O(t){27===t.keyCode&&E()}function T(t){2!=t.button&&(tt||(Ut?R(!0):D(),E()))}function E(){Z&&!V&&(Z=!1,t(wt).unbind("keydown.spectrum",O),t(wt).unbind("click.spectrum",T),t(window).unbind("resize.spectrum",Q),Lt.removeClass("sp-active"),kt.addClass("sp-hidden"),G.hide(Y()),Ct.trigger("hide.spectrum",[Y()]))}function D(){M(zt,!0)}function M(t,e){if(tinycolor.equals(t,Y()))return void H();var n,a;!t&&Jt?Kt=!0:(Kt=!1,n=tinycolor(t),a=n.toHsv(),ct=a.h%360/360,dt=a.s,ft=a.v,ut=a.a),H(),n&&n.isValid()&&!e&&(Vt=z.preferredFormat||n.getFormat())}function Y(t){return t=t||{},Jt&&Kt?null:tinycolor.fromRatio({h:ct,s:dt,v:ft,a:Math.round(100*ut)/100},{format:t.format||Vt})}function X(){return!Dt.hasClass("sp-validation-error")}function P(){H(),G.move(Y()),Ct.trigger("move.spectrum",[Y()])}function H(){Dt.removeClass("sp-validation-error"),F();var t=tinycolor.fromRatio({h:ct,s:1,v:1});xt.css("background-color",t.toHexString());var e=Vt;1>ut&&(0!==ut||"name"!==e)&&("hex"===e||"hex3"===e||"hex6"===e||"name"===e)&&(e="rgb");var n=Y({format:e}),a="";if(Bt.removeClass("sp-clear-display"),Bt.css("background-color","transparent"),!n&&Jt)Bt.addClass("sp-clear-display");else{var o=n.toHexString(),i=n.toRgbString();if(v||1===n.alpha?Bt.css("background-color",i):(Bt.css("background-color","transparent"),Bt.css("filter",n.toFilter())),z.showAlpha){var r=n.toRgb();r.a=0;var s=tinycolor(r).toRgbString(),l="linear-gradient(left, "+s+", "+o+")";p?Ot.css("filter",tinycolor(s).toFilter({gradientType:1},o)):(Ot.css("background","-webkit-"+l),Ot.css("background","-moz-"+l),Ot.css("background","-ms-"+l),Ot.css("background","linear-gradient(to right, "+s+", "+o+")"))}a=n.toString(e)}z.showInput&&Dt.val(a),z.showPalette&&_(),k()}function F(){var t=dt,e=ft;if(Jt&&Kt)Et.hide(),$t.hide(),jt.hide();else{Et.show(),$t.show(),jt.show();var n=t*et,a=nt-e*nt;n=Math.max(-at,Math.min(et-at,n-at)),a=Math.max(-at,Math.min(nt-at,a-at)),jt.css({top:a+"px",left:n+"px"});var o=ut*rt;Et.css({left:o-st/2+"px"});var i=ct*ot;$t.css({top:i-lt+"px"})}}function R(t){var e=Y(),n="",a=!tinycolor.equals(e,zt);e&&(n=e.toString(Vt),w(e)),Rt&&Ct.val(n),t&&a&&(G.change(e),Ct.trigger("change",[e]))}function I(){Z&&(et=xt.width(),nt=xt.height(),at=jt.height(),it=At.width(),ot=At.height(),lt=$t.height(),rt=Tt.width(),st=Et.width(),V||(kt.css("position","absolute"),z.offset?kt.offset(z.offset):kt.offset(r(kt,Wt))),F(),z.showPalette&&_(),Ct.trigger("reflow.spectrum"))}function N(){Ct.show(),Wt.unbind("click.spectrum touchstart.spectrum"),kt.remove(),Lt.remove(),g[Gt.id]=null}function L(n,a){return n===e?t.extend({},z):a===e?z[n]:(z[n]=a,"preferredFormat"===n&&(Vt=z.preferredFormat),void c())}function W(){_t=!1,Ct.attr("disabled",!1),Wt.removeClass("sp-disabled")}function B(){E(),_t=!0,Ct.attr("disabled",!0),Wt.addClass("sp-disabled")}function q(t){z.offset=t,I()}var z=o(s,i),V=z.flat,U=z.showSelectionPalette,K=z.localStorageKey,J=z.theme,G=z.callbacks,Q=f(I,10),Z=!1,tt=!1,et=0,nt=0,at=0,ot=0,it=0,rt=0,st=0,lt=0,ct=0,dt=0,ft=0,ut=1,ht=[],gt=[],pt={},vt=z.selectionPalette.slice(0),bt=z.maxSelectionSize,mt="sp-dragging",yt=null,wt=i.ownerDocument,Ct=(wt.body,t(i)),_t=!1,kt=t(m,wt).addClass(J),St=kt.find(".sp-picker-container"),xt=kt.find(".sp-color"),jt=kt.find(".sp-dragger"),At=kt.find(".sp-hue"),$t=kt.find(".sp-slider"),Ot=kt.find(".sp-alpha-inner"),Tt=kt.find(".sp-alpha"),Et=kt.find(".sp-alpha-handle"),Dt=kt.find(".sp-input"),Mt=kt.find(".sp-palette"),Yt=kt.find(".sp-initial"),Xt=kt.find(".sp-cancel"),Pt=kt.find(".sp-clear"),Ht=kt.find(".sp-choose"),Ft=kt.find(".sp-palette-toggle"),Rt=Ct.is("input"),It=Rt&&"color"===Ct.attr("type")&&u(),Nt=Rt&&!V,Lt=Nt?t(b).addClass(J).addClass(z.className).addClass(z.replacerClassName):t([]),Wt=Nt?Lt:Ct,Bt=Lt.find(".sp-preview-inner"),qt=z.color||Rt&&Ct.val(),zt=!1,Vt=z.preferredFormat,Ut=!z.showButtons||z.clickoutFiresChange,Kt=!qt,Jt=z.allowEmpty&&!It;h();var Gt={show:$,hide:E,toggle:A,reflow:I,option:L,enable:W,disable:B,offset:q,set:function(t){M(t),R()},get:Y,destroy:N,container:kt};return Gt.id=g.push(Gt)-1,Gt}function r(e,n){var a=0,o=e.outerWidth(),i=e.outerHeight(),r=n.outerHeight(),s=e[0].ownerDocument,l=s.documentElement,c=l.clientWidth+t(s).scrollLeft(),d=l.clientHeight+t(s).scrollTop(),f=n.offset();return f.top+=r,f.left-=Math.min(f.left,f.left+o>c&&c>o?Math.abs(f.left+o-c):0),f.top-=Math.min(f.top,f.top+i>d&&d>i?Math.abs(i+r-a):a),f}function s(){}function l(t){t.stopPropagation()}function c(t,e){var n=Array.prototype.slice,a=n.call(arguments,2);return function(){return t.apply(e,a.concat(n.call(arguments)))}}function d(e,n,a,o){function i(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function r(t){if(d){if(p&&c.documentMode<9&&!t.button)return l();var a=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0],o=a&&a.pageX||t.pageX,r=a&&a.pageY||t.pageY,s=Math.max(0,Math.min(o-f.left,h)),v=Math.max(0,Math.min(r-f.top,u));g&&i(t),n.apply(e,[s,v,t])}}function s(n){var o=n.which?3==n.which:2==n.button;o||d||a.apply(e,arguments)!==!1&&(d=!0,u=t(e).height(),h=t(e).width(),f=t(e).offset(),t(c).bind(v),t(c.body).addClass("sp-dragging"),r(n),i(n))}function l(){d&&(t(c).unbind(v),t(c.body).removeClass("sp-dragging"),setTimeout(function(){o.apply(e,arguments)},0)),d=!1}n=n||function(){},a=a||function(){},o=o||function(){};var c=document,d=!1,f={},u=0,h=0,g="ontouchstart"in window,v={};v.selectstart=i,v.dragstart=i,v["touchmove mousemove"]=r,v["touchend mouseup"]=l,t(e).bind("touchstart mousedown",s)}function f(t,e,n){var a;return function(){var o=this,i=arguments,r=function(){a=null,t.apply(o,i)};n&&clearTimeout(a),(n||!a)&&(a=setTimeout(r,e))}}function u(){return t.fn.spectrum.inputTypeColorSupport()}var h={beforeShow:s,move:s,change:s,show:s,hide:s,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},g=[],p=!!/msie/i.exec(window.navigator.userAgent),v=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div"),n=e.style;return n.cssText="background-color:rgba(0,0,0,.5)",t(n.backgroundColor,"rgba")||t(n.backgroundColor,"hsla")}(),b=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),m=function(){var t="";if(p)for(var e=1;6>=e;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),y="spectrum.id";t.fn.spectrum=function(e,n){if("string"==typeof e){var a=this,o=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=g[t(this).data(y)];if(n){var i=n[e];if(!i)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?a=n.get():"container"==e?a=n.container:"option"==e?a=n.option.apply(n,o):"destroy"==e?(n.destroy(),t(this).removeData(y)):i.apply(n,o)}}),a}return this.spectrum("destroy").each(function(){var n=t.extend({},e,t(this).data()),a=i(this,n);t(this).data(y,a.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=d,t.fn.spectrum.defaults=h,t.fn.spectrum.inputTypeColorSupport=function w(){if("undefined"==typeof w._cachedResult){var e=t("<input type='color'/>")[0];w._cachedResult="color"===e.type&&""!==e.value}return w._cachedResult},t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var e=t("input[type=color]");e.length&&!u()&&e.spectrum({preferredFormat:"hex6"})},function(){function t(t){var n={r:0,g:0,b:0},o=1,r=!1,s=!1;return"string"==typeof t&&(t=D(t)),"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(n=e(t.r,t.g,t.b),r=!0,s="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=O(t.s),t.v=O(t.v),n=i(t.h,t.s,t.v),r=!0,s="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=O(t.s),t.l=O(t.l),n=a(t.h,t.s,t.l),r=!0,s="hsl"),t.hasOwnProperty("a")&&(o=t.a)),o=_(o),{ok:r,format:t.format||s,r:F(255,R(n.r,0)),g:F(255,R(n.g,0)),b:F(255,R(n.b,0)),a:o}}function e(t,e,n){return{r:255*k(t,255),g:255*k(e,255),b:255*k(n,255)}}function n(t,e,n){t=k(t,255),e=k(e,255),n=k(n,255);var a,o,i=R(t,e,n),r=F(t,e,n),s=(i+r)/2;if(i==r)a=o=0;else{var l=i-r;switch(o=s>.5?l/(2-i-r):l/(i+r),i){case t:a=(e-n)/l+(n>e?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4}a/=6}return{h:a,s:o,l:s}}function a(t,e,n){function a(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+(e-t)*(2/3-n)*6:t}var o,i,r;if(t=k(t,360),e=k(e,100),n=k(n,100),0===e)o=i=r=n;else{var s=.5>n?n*(1+e):n+e-n*e,l=2*n-s;o=a(l,s,t+1/3),i=a(l,s,t),r=a(l,s,t-1/3)}return{r:255*o,g:255*i,b:255*r}}function o(t,e,n){t=k(t,255),e=k(e,255),n=k(n,255);var a,o,i=R(t,e,n),r=F(t,e,n),s=i,l=i-r;if(o=0===i?0:l/i,i==r)a=0;else{switch(i){case t:a=(e-n)/l+(n>e?6:0);break;case e:a=(n-t)/l+2;break;case n:a=(t-e)/l+4}a/=6}return{h:a,s:o,v:s}}function i(t,e,n){t=6*k(t,360),e=k(e,100),n=k(n,100);var a=P.floor(t),o=t-a,i=n*(1-e),r=n*(1-o*e),s=n*(1-(1-o)*e),l=a%6,c=[n,r,i,i,s,n][l],d=[s,n,n,r,i,i][l],f=[i,i,s,n,n,r][l];return{r:255*c,g:255*d,b:255*f}}function r(t,e,n,a){var o=[$(H(t).toString(16)),$(H(e).toString(16)),$(H(n).toString(16))];return a&&o[0].charAt(0)==o[0].charAt(1)&&o[1].charAt(0)==o[1].charAt(1)&&o[2].charAt(0)==o[2].charAt(1)?o[0].charAt(0)+o[1].charAt(0)+o[2].charAt(0):o.join("")}function s(t,e,n,a){var o=[$(T(a)),$(H(t).toString(16)),$(H(e).toString(16)),$(H(n).toString(16))];return o.join("")}function l(t,e){e=0===e?0:e||10;var n=N(t).toHsl();return n.s-=e/100,n.s=S(n.s),N(n)}function c(t,e){e=0===e?0:e||10;var n=N(t).toHsl();return n.s+=e/100,n.s=S(n.s),N(n)}function d(t){return N(t).desaturate(100)}function f(t,e){e=0===e?0:e||10;var n=N(t).toHsl();return n.l+=e/100,n.l=S(n.l),N(n)}function u(t,e){e=0===e?0:e||10;var n=N(t).toRgb();return n.r=R(0,F(255,n.r-H(255*-(e/100)))),n.g=R(0,F(255,n.g-H(255*-(e/100)))),n.b=R(0,F(255,n.b-H(255*-(e/100)))),N(n)}function h(t,e){e=0===e?0:e||10;var n=N(t).toHsl();return n.l-=e/100,n.l=S(n.l),N(n)}function g(t,e){var n=N(t).toHsl(),a=(H(n.h)+e)%360;return n.h=0>a?360+a:a,N(n)}function p(t){var e=N(t).toHsl();return e.h=(e.h+180)%360,N(e)}function v(t){var e=N(t).toHsl(),n=e.h;return[N(t),N({h:(n+120)%360,s:e.s,l:e.l}),N({h:(n+240)%360,s:e.s,l:e.l})]}function b(t){var e=N(t).toHsl(),n=e.h;return[N(t),N({h:(n+90)%360,s:e.s,l:e.l}),N({h:(n+180)%360,s:e.s,l:e.l}),N({h:(n+270)%360,s:e.s,l:e.l})]}function m(t){var e=N(t).toHsl(),n=e.h;return[N(t),N({h:(n+72)%360,s:e.s,l:e.l}),N({h:(n+216)%360,s:e.s,l:e.l})]}function y(t,e,n){e=e||6,n=n||30;var a=N(t).toHsl(),o=360/n,i=[N(t)];for(a.h=(a.h-(o*e>>1)+720)%360;--e;)a.h=(a.h+o)%360,i.push(N(a));return i}function w(t,e){e=e||6;for(var n=N(t).toHsv(),a=n.h,o=n.s,i=n.v,r=[],s=1/e;e--;)r.push(N({h:a,s:o,v:i})),i=(i+s)%1;return r}function C(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function _(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function k(t,e){j(t)&&(t="100%");var n=A(t);return t=F(e,R(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),P.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return F(1,R(0,t))}function x(t){return parseInt(t,16)}function j(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function A(t){return"string"==typeof t&&-1!=t.indexOf("%")}function $(t){return 1==t.length?"0"+t:""+t}function O(t){return 1>=t&&(t=100*t+"%"),t}function T(t){return Math.round(255*parseFloat(t)).toString(16)}function E(t){return x(t)/255}function D(t){t=t.replace(M,"").replace(Y,"").toLowerCase();var e=!1;if(L[t])t=L[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=B.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=B.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=B.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=B.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=B.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=B.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=B.hex8.exec(t))?{a:E(n[1]),r:x(n[2]),g:x(n[3]),b:x(n[4]),format:e?"name":"hex8"}:(n=B.hex6.exec(t))?{r:x(n[1]),g:x(n[2]),b:x(n[3]),format:e?"name":"hex"}:(n=B.hex3.exec(t))?{r:x(n[1]+""+n[1]),g:x(n[2]+""+n[2]),b:x(n[3]+""+n[3]),format:e?"name":"hex"}:!1}var M=/^[\s,#]+/,Y=/\s+$/,X=0,P=Math,H=P.round,F=P.min,R=P.max,I=P.random,N=function q(e,n){if(e=e?e:"",n=n||{},e instanceof q)return e;if(!(this instanceof q))return new q(e,n);var a=t(e);this._originalInput=e,this._r=a.r,this._g=a.g,this._b=a.b,this._a=a.a,this._roundA=H(100*this._a)/100,this._format=n.format||a.format,this._gradientType=n.gradientType,this._r<1&&(this._r=H(this._r)),this._g<1&&(this._g=H(this._g)),this._b<1&&(this._b=H(this._b)),this._ok=a.ok,this._tc_id=X++};N.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=_(t),this._roundA=H(100*this._a)/100,this},toHsv:function(){var t=o(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=o(this._r,this._g,this._b),e=H(360*t.h),n=H(100*t.s),a=H(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+a+"%)":"hsva("+e+", "+n+"%, "+a+"%, "+this._roundA+")"},toHsl:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=n(this._r,this._g,this._b),e=H(360*t.h),a=H(100*t.s),o=H(100*t.l);return 1==this._a?"hsl("+e+", "+a+"%, "+o+"%)":"hsla("+e+", "+a+"%, "+o+"%, "+this._roundA+")"},toHex:function(t){return r(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return s(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:H(this._r),g:H(this._g),b:H(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+H(this._r)+", "+H(this._g)+", "+H(this._b)+")":"rgba("+H(this._r)+", "+H(this._g)+", "+H(this._b)+", "+this._roundA+")";
},toPercentageRgb:function(){return{r:H(100*k(this._r,255))+"%",g:H(100*k(this._g,255))+"%",b:H(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+H(100*k(this._r,255))+"%, "+H(100*k(this._g,255))+"%, "+H(100*k(this._b,255))+"%)":"rgba("+H(100*k(this._r,255))+"%, "+H(100*k(this._g,255))+"%, "+H(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:W[r(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+s(this._r,this._g,this._b,this._a),n=e,a=this._gradientType?"GradientType = 1, ":"";if(t){var o=N(t);n=o.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+a+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,a=this._a<1&&this._a>=0,o=!e&&a&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return o?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(u,arguments)},darken:function(){return this._applyModification(h,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(d,arguments)},spin:function(){return this._applyModification(g,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(y,arguments)},complement:function(){return this._applyCombination(p,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(m,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(b,arguments)}},N.fromRatio=function(t,e){if("object"==("undefined"==typeof t?"undefined":_typeof(t))){var n={};for(var a in t)t.hasOwnProperty(a)&&("a"===a?n[a]=t[a]:n[a]=O(t[a]));t=n}return N(t,e)},N.equals=function(t,e){return t&&e?N(t).toRgbString()==N(e).toRgbString():!1},N.random=function(){return N.fromRatio({r:I(),g:I(),b:I()})},N.mix=function(t,e,n){n=0===n?0:n||50;var a,o=N(t).toRgb(),i=N(e).toRgb(),r=n/100,s=2*r-1,l=i.a-o.a;a=s*l==-1?s:(s+l)/(1+s*l),a=(a+1)/2;var c=1-a,d={r:i.r*a+o.r*c,g:i.g*a+o.g*c,b:i.b*a+o.b*c,a:i.a*r+o.a*(1-r)};return N(d)},N.readability=function(t,e){var n=N(t),a=N(e),o=n.toRgb(),i=a.toRgb(),r=n.getBrightness(),s=a.getBrightness(),l=Math.max(o.r,i.r)-Math.min(o.r,i.r)+Math.max(o.g,i.g)-Math.min(o.g,i.g)+Math.max(o.b,i.b)-Math.min(o.b,i.b);return{brightness:Math.abs(r-s),color:l}},N.isReadable=function(t,e){var n=N.readability(t,e);return n.brightness>125&&n.color>500},N.mostReadable=function(t,e){for(var n=null,a=0,o=!1,i=0;i<e.length;i++){var r=N.readability(t,e[i]),s=r.brightness>125&&r.color>500,l=3*(r.brightness/125)+r.color/500;(s&&!o||s&&o&&l>a||!s&&!o&&l>a)&&(o=s,a=l,n=N(e[i]))}return n};var L=N.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},W=N.hexNames=C(L),B=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",a="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",o="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+a),rgba:new RegExp("rgba"+o),hsl:new RegExp("hsl"+a),hsla:new RegExp("hsla"+o),hsv:new RegExp("hsv"+a),hsva:new RegExp("hsva"+o),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=N}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=m({},e),t[F]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var a in n)!(a in e)&&(e[a]=n[a]);U(e);for(var i in this)"_"===i.charAt(0)&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:L,o(t,"mousedown",this._onTapStart),o(t,"touchstart",this._onTapStart),this.nativeDraggable&&(o(t,"dragover",this),o(t,"dragenter",this)),z.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t){_&&_.state!==t&&(s(_,"display",t?"none":""),!t&&_.state&&k.insertBefore(_,y),_.state=t)}function n(t,e,n){if(t){n=n||I;do if(">*"===e&&t.parentNode===n||v(t,e))return t;while(t!==n&&(t=t.parentNode))}return null}function a(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function o(t,e,n){t.addEventListener(e,n,!1)}function i(t,e,n){t.removeEventListener(e,n,!1)}function r(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var a=(" "+t.className+" ").replace(H," ").replace(" "+e+" "," ");t.className=(a+(n?" "+e:"")).replace(H," ")}}function s(t,e,n){var a=t&&t.style;if(a){if(void 0===n)return I.defaultView&&I.defaultView.getComputedStyle?n=I.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in a||(e="-webkit-"+e),a[e]=n+("string"==typeof n?"":"px")}}function l(t,e,n){if(t){var a=t.getElementsByTagName(e),o=0,i=a.length;if(n)for(;i>o;o++)n(a[o],o);return a}return[]}function c(t,e,n,a,o,i,r){var s=I.createEvent("Event"),l=(t||e[F]).options,c="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=o||e,s.item=a||e,s.clone=_,s.oldIndex=i,s.newIndex=r,e.dispatchEvent(s),l[c]&&l[c].call(t,s)}function d(t,e,n,a,o,i){var r,s,l=t[F],c=l.options.onMove;return r=I.createEvent("Event"),r.initEvent("move",!0,!0),r.to=e,r.from=t,r.dragged=n,r.draggedRect=a,r.related=o||e,r.relatedRect=i||e.getBoundingClientRect(),t.dispatchEvent(r),c&&(s=c.call(l,r)),s}function f(t){t.draggable=!1}function u(){B=!1}function h(t,e){var n=t.lastElementChild,a=n.getBoundingClientRect();return(e.clientY-(a.top+a.height)>5||e.clientX-(a.right+a.width)>5)&&n}function g(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,a=0;n--;)a+=e.charCodeAt(n);return a.toString(36)}function p(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&v(t,e)&&n++;return n}function v(t,e){if(t){e=e.split(".");var n=e.shift().toUpperCase(),a=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(a)||[]).length!=e.length)}return!1}function b(t,e){var n,a;return function(){void 0===n&&(n=arguments,a=this,setTimeout(function(){1===n.length?t.call(a,n[0]):t.apply(a,n),n=void 0},e))}}function m(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}if("undefined"==typeof window||"undefined"==typeof window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var y,w,C,_,k,S,x,j,A,$,O,T,E,D,M,Y,X,P={},H=/\s+/g,F="Sortable"+(new Date).getTime(),R=window,I=R.document,N=R.parseInt,L=!!("draggable"in I.createElement("div")),W=function(t){return t=I.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}(),B=!1,q=Math.abs,z=([].slice,[]),V=b(function(t,e,n){if(n&&e.scroll){var a,o,i,r,s=e.scrollSensitivity,l=e.scrollSpeed,c=t.clientX,d=t.clientY,f=window.innerWidth,u=window.innerHeight;if(j!==n&&(x=e.scroll,j=n,x===!0)){x=n;do if(x.offsetWidth<x.scrollWidth||x.offsetHeight<x.scrollHeight)break;while(x=x.parentNode)}x&&(a=x,o=x.getBoundingClientRect(),i=(q(o.right-c)<=s)-(q(o.left-c)<=s),r=(q(o.bottom-d)<=s)-(q(o.top-d)<=s)),i||r||(i=(s>=f-c)-(s>=c),r=(s>=u-d)-(s>=d),(i||r)&&(a=R)),(P.vx!==i||P.vy!==r||P.el!==a)&&(P.el=a,P.vx=i,P.vy=r,clearInterval(P.pid),a&&(P.pid=setInterval(function(){a===R?R.scrollTo(R.pageXOffset+i*l,R.pageYOffset+r*l):(r&&(a.scrollTop+=r*l),i&&(a.scrollLeft+=i*l))},24)))}},30),U=function(t){var e=t.group;e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))||(e=t.group={name:e}),["pull","put"].forEach(function(t){t in e||(e[t]=!0)}),t.groups=" "+e.name+(e.put.join?" "+e.put.join(" "):"")+" "};return t.prototype={constructor:t,_onTapStart:function(t){var e=this,a=this.el,o=this.options,i=t.type,r=t.touches&&t.touches[0],s=(r||t).target,l=s,d=o.filter;if(!("mousedown"===i&&0!==t.button||o.disabled)&&(s=n(s,o.draggable,a))){if(T=p(s,o.draggable),"function"==typeof d){if(d.call(this,t,s,this))return c(e,l,"filter",s,a,T),void t.preventDefault()}else if(d&&(d=d.split(",").some(function(t){return t=n(l,t.trim(),a),t?(c(e,t,"filter",s,a,T),!0):void 0})))return void t.preventDefault();(!o.handle||n(l,o.handle,a))&&this._prepareDragStart(t,r,s)}},_prepareDragStart:function(t,e,n){var a,i=this,s=i.el,c=i.options,d=s.ownerDocument;n&&!y&&n.parentNode===s&&(M=t,k=s,y=n,w=y.parentNode,S=y.nextSibling,D=c.group,a=function(){i._disableDelayedDrag(),y.draggable=!0,r(y,i.options.chosenClass,!0),i._triggerDragStart(e)},c.ignore.split(",").forEach(function(t){l(y,t.trim(),f)}),o(d,"mouseup",i._onDrop),o(d,"touchend",i._onDrop),o(d,"touchcancel",i._onDrop),c.delay?(o(d,"mouseup",i._disableDelayedDrag),o(d,"touchend",i._disableDelayedDrag),o(d,"touchcancel",i._disableDelayedDrag),o(d,"mousemove",i._disableDelayedDrag),o(d,"touchmove",i._disableDelayedDrag),i._dragStartTimer=setTimeout(a,c.delay)):a())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),i(t,"mouseup",this._disableDelayedDrag),i(t,"touchend",this._disableDelayedDrag),i(t,"touchcancel",this._disableDelayedDrag),i(t,"mousemove",this._disableDelayedDrag),i(t,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(M={target:y,clientX:t.clientX,clientY:t.clientY},this._onDragStart(M,"touch")):this.nativeDraggable?(o(y,"dragend",this),o(k,"dragstart",this._onDragStart)):this._onDragStart(M,!0);try{I.selection?I.selection.empty():window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){k&&y&&(r(y,this.options.ghostClass,!0),t.active=this,c(this,k,"start",y,k,T))},_emulateDragOver:function(){if(Y){if(this._lastX===Y.clientX&&this._lastY===Y.clientY)return;this._lastX=Y.clientX,this._lastY=Y.clientY,W||s(C,"display","none");var t=I.elementFromPoint(Y.clientX,Y.clientY),e=t,n=" "+this.options.group.name,a=z.length;if(e)do{if(e[F]&&e[F].options.groups.indexOf(n)>-1){for(;a--;)z[a]({clientX:Y.clientX,clientY:Y.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);W||s(C,"display","")}},_onTouchMove:function(e){if(M){t.active||this._dragStarted(),this._appendGhost();var n=e.touches?e.touches[0]:e,a=n.clientX-M.clientX,o=n.clientY-M.clientY,i=e.touches?"translate3d("+a+"px,"+o+"px,0)":"translate("+a+"px,"+o+"px)";X=!0,Y=n,s(C,"webkitTransform",i),s(C,"mozTransform",i),s(C,"msTransform",i),s(C,"transform",i),e.preventDefault()}},_appendGhost:function(){if(!C){var t,e=y.getBoundingClientRect(),n=s(y),a=this.options;C=y.cloneNode(!0),r(C,a.ghostClass,!1),r(C,a.fallbackClass,!0),s(C,"top",e.top-N(n.marginTop,10)),s(C,"left",e.left-N(n.marginLeft,10)),s(C,"width",e.width),s(C,"height",e.height),s(C,"opacity","0.8"),s(C,"position","fixed"),s(C,"zIndex","100000"),s(C,"pointerEvents","none"),a.fallbackOnBody&&I.body.appendChild(C)||k.appendChild(C),t=C.getBoundingClientRect(),s(C,"width",2*e.width-t.width),s(C,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,a=this.options;this._offUpEvents(),"clone"==D.pull&&(_=y.cloneNode(!0),s(_,"display","none"),k.insertBefore(_,y)),e?("touch"===e?(o(I,"touchmove",this._onTouchMove),o(I,"touchend",this._onDrop),o(I,"touchcancel",this._onDrop)):(o(I,"mousemove",this._onTouchMove),o(I,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",a.setData&&a.setData.call(this,n,y)),o(I,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var a,o,i,r=this.el,l=this.options,c=l.group,f=c.put,g=D===c,p=l.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),!l.dragoverBubble&&t.stopPropagation()),X=!0,D&&!l.disabled&&(g?p||(i=!k.contains(y)):D.pull&&f&&(D.name===c.name||f.indexOf&&~f.indexOf(D.name)))&&(void 0===t.rootEl||t.rootEl===this.el)){if(V(t,l,this.el),B)return;if(a=n(t.target,l.draggable,r),o=y.getBoundingClientRect(),i)return e(!0),void(_||S?k.insertBefore(y,_||S):p||k.appendChild(y));if(0===r.children.length||r.children[0]===C||r===t.target&&(a=h(r,t))){if(a){if(a.animated)return;b=a.getBoundingClientRect()}e(g),d(k,r,y,o,a,b)!==!1&&(y.contains(r)||(r.appendChild(y),w=r),this._animate(o,y),a&&this._animate(b,a))}else if(a&&!a.animated&&a!==y&&void 0!==a.parentNode[F]){A!==a&&(A=a,$=s(a),O=s(a.parentNode));var v,b=a.getBoundingClientRect(),m=b.right-b.left,x=b.bottom-b.top,j=/left|right|inline/.test($.cssFloat+$.display)||"flex"==O.display&&0===O["flex-direction"].indexOf("row"),T=a.offsetWidth>y.offsetWidth,E=a.offsetHeight>y.offsetHeight,M=(j?(t.clientX-b.left)/m:(t.clientY-b.top)/x)>.5,Y=a.nextElementSibling,P=d(k,r,y,o,a,b);if(P!==!1){if(B=!0,setTimeout(u,30),e(g),1===P||-1===P)v=1===P;else if(j){var H=y.offsetTop,R=a.offsetTop;v=H===R?a.previousElementSibling===y&&!T||M&&T:R>H}else v=Y!==y&&!E||M&&E;y.contains(r)||(v&&!Y?r.appendChild(y):a.parentNode.insertBefore(y,v?Y:a)),w=y.parentNode,this._animate(o,y),this._animate(b,a)}}}},_animate:function(t,e){var n=this.options.animation;if(n){var a=e.getBoundingClientRect();s(e,"transition","none"),s(e,"transform","translate3d("+(t.left-a.left)+"px,"+(t.top-a.top)+"px,0)"),e.offsetWidth,s(e,"transition","all "+n+"ms"),s(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){s(e,"transition",""),s(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;i(I,"touchmove",this._onTouchMove),i(t,"mouseup",this._onDrop),i(t,"touchend",this._onDrop),i(t,"touchcancel",this._onDrop)},_onDrop:function(e){var n=this.el,a=this.options;clearInterval(this._loopId),clearInterval(P.pid),clearTimeout(this._dragStartTimer),i(I,"mousemove",this._onTouchMove),this.nativeDraggable&&(i(I,"drop",this),i(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(X&&(e.preventDefault(),!a.dropBubble&&e.stopPropagation()),C&&C.parentNode.removeChild(C),y&&(this.nativeDraggable&&i(y,"dragend",this),f(y),r(y,this.options.ghostClass,!1),r(y,this.options.chosenClass,!1),k!==w?(E=p(y,a.draggable),E>=0&&(c(null,w,"sort",y,k,T,E),c(this,k,"sort",y,k,T,E),c(null,w,"add",y,k,T,E),c(this,k,"remove",y,k,T,E))):(_&&_.parentNode.removeChild(_),y.nextSibling!==S&&(E=p(y,a.draggable),E>=0&&(c(this,k,"update",y,k,T,E),c(this,k,"sort",y,k,T,E)))),t.active&&((null===E||-1===E)&&(E=T),c(this,k,"end",y,k,T,E),this.save()))),this._nulling()},_nulling:function(){k=y=w=C=S=_=x=j=M=Y=X=E=A=$=D=t.active=null},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?y&&(this._onDragOver(t),a(t)):("drop"===e||"dragend"===e)&&this._onDrop(t)},toArray:function(){for(var t,e=[],a=this.el.children,o=0,i=a.length,r=this.options;i>o;o++)t=a[o],n(t,r.draggable,this.el)&&e.push(t.getAttribute(r.dataIdAttr)||g(t));return e},sort:function(t){var e={},a=this.el;this.toArray().forEach(function(t,o){var i=a.children[o];n(i,this.options.draggable,a)&&(e[t]=i)},this),t.forEach(function(t){e[t]&&(a.removeChild(e[t]),a.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&U(n)))},destroy:function(){var t=this.el;t[F]=null,i(t,"mousedown",this._onTapStart),i(t,"touchstart",this._onTapStart),this.nativeDraggable&&(i(t,"dragover",this),i(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),z.splice(z.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},t.utils={on:o,off:i,css:s,find:l,is:function(t,e){return!!n(t,e,t)},extend:m,throttle:b,closest:n,toggleClass:r,index:p},t.create=function(e,n){return new t(e,n)},t.version="1.4.2",t});