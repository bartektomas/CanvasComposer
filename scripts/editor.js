function getThumbnails(t,e){var n="https://www.googleapis.com/youtube/v3/videos?id="+t+"&part=snippet&key=AIzaSyCjiWPLJdE-QbakmKin__3rDqOKLgKyCRY";$.getJSON(n,function(){console.log("success")}).done(function(t){console.log(t);var n;return n=""!=t.items[0].snippet.thumbnails.standard.url?t.items[0].snippet.thumbnails.standard.url:t.items[0].snippet.thumbnails["default"].url,e(n)}).fail(function(t){console.log(t)})}function validateYouTubeUrl(t){if(void 0!=t||""!=t){var e=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=|\?v=)([^#\&\?]*).*/,n=t.match(e);return n&&11==n[2].length?n[2]:!1}}function IDGenerator(){this.length=8,this.timestamp=+new Date;var t=function(t,e){return Math.floor(Math.random()*(e-t+1))+t};this.generate=function(){for(var e=this.timestamp.toString(),n=e.split("").reverse(),r="",a=0;a<this.length;++a){var i=t(0,n.length-1);r+=n[i]}return r}}function findObj(t){for(var e=0;e<canvas._objects.length;e++){if(canvas._objects[e].id===t)return canvas._objects[e];console.log(canvas._objects[e])}}function roundToGrid(t){return Math.round(t/grid)*grid}function fixBoundaries(t){if(t.target){var e=t.target,n=!1,r={left:e.left,right:e.left+e.width*e.scaleX,top:e.top,bottom:e.top+e.height*e.scaleY},a={left:0,top:0,right:canvas.getWidth(),bottom:canvas.getHeight()},i={};return r.left<a.left&&(n=!0,i.left=a.left),r.top<a.top&&(n=!0,i.top=a.top),r.right>a.right&&(n=!0,i.left=r.left-(r.right-a.right)),r.bottom>a.bottom&&(n=!0,i.top=r.top-(r.bottom-a.bottom)),n&&(e.set(i),canvas.renderAll()),t}}function snapMoveToGrid(t){var e=t.target,n=e.width*e.scaleX,r=e.height*e.scaleY,a={top:roundToGrid(e.top),left:roundToGrid(e.left),bottom:roundToGrid(e.top+r),right:roundToGrid(e.left+n)},i={top:Math.abs(a.top-e.top),left:Math.abs(a.left-e.left),bottom:Math.abs(a.bottom-e.top-r),right:Math.abs(a.right-e.left-n)};i.bottom<i.top?i.bottom>threshold?a.top=e.top:a.top=a.bottom-r:i.top>threshold&&(a.top=e.top),i.right<i.left?i.right>threshold?a.left=e.left:a.left=a.right-n:i.left>threshold&&(a.left=e.left),e.set({top:a.top,left:a.left})}function snapScaleToGrid(t){var e=t.target,n=e.getWidth(),r=e.getHeight(),a={top:roundToGrid(e.top),left:roundToGrid(e.left),bottom:roundToGrid(e.top+r),right:roundToGrid(e.left+n)},i={top:Math.abs(a.top-e.top),left:Math.abs(a.left-e.left),bottom:Math.abs(a.bottom-e.top-r),right:Math.abs(a.right-e.left-n)},o={scaleX:e.scaleX,scaleY:e.scaleY,top:e.top,left:e.left};switch(e.__corner){case"tl":i.left<i.top&&i.left<threshold?(o.scaleX=(n-(a.left-e.left))/e.width,o.scaleY=o.scaleX/e.scaleX*e.scaleY,o.top=e.top+(r-e.height*o.scaleY),o.left=a.left):i.top<threshold&&(o.scaleY=(r-(a.top-e.top))/e.height,o.scaleX=o.scaleY/e.scaleY*e.scaleX,o.left=o.left+(n-e.width*o.scaleX),o.top=a.top);break;case"mt":i.top<threshold&&(o.scaleY=(r-(a.top-e.top))/e.height,o.top=a.top);break;case"tr":i.right<i.top&&i.right<threshold?(o.scaleX=(a.right-e.left)/e.width,o.scaleY=o.scaleX/e.scaleX*e.scaleY,o.top=e.top+(r-e.height*o.scaleY)):i.top<threshold&&(o.scaleY=(r-(a.top-e.top))/e.height,o.scaleX=o.scaleY/e.scaleY*e.scaleX,o.top=a.top);break;case"ml":i.left<threshold&&(o.scaleX=(n-(a.left-e.left))/e.width,o.left=a.left);break;case"mr":i.right<threshold&&(o.scaleX=(a.right-e.left)/e.width);break;case"bl":i.left<i.bottom&&i.left<threshold?(o.scaleX=(n-(a.left-e.left))/e.width,o.scaleY=o.scaleX/e.scaleX*e.scaleY,o.left=a.left):i.bottom<threshold&&(o.scaleY=(a.bottom-e.top)/e.height,o.scaleX=o.scaleY/e.scaleY*e.scaleX,o.left=o.left+(n-e.width*o.scaleX));break;case"mb":i.bottom<threshold&&(o.scaleY=(a.bottom-e.top)/e.height);break;case"br":i.right<i.bottom&&i.right<threshold?(o.scaleX=(a.right-e.left)/e.width,o.scaleY=o.scaleX/e.scaleX*e.scaleY):i.bottom<threshold&&(o.scaleY=(a.bottom-e.top)/e.height,o.scaleX=o.scaleY/e.scaleY*e.scaleX)}e.set(o)}function artboardScale(){var t=(canvas.width/canvas.height,canvas.width/container.clientWidth),e=canvas.height/container.clientHeight;console.log("W:"+t),console.log("H:"+e);var n;t>=e?t>1?(t=container.clientWidth/canvas.width,n=t*t,console.log(t),n>1&&(n=1),paintArea.style.transform="scale("+n+")",paintArea.style.transformOrigin="25% 25%"):(n=1,paintArea.style.transform="scale("+n+")",paintArea.style.transformOrigin="25% 25%"):e>t&&(e>1?(e=container.clientHeight/canvas.height,n=e*e,console.log(e),n>1&&(n=1),paintArea.style.transform="scale("+n+")",paintArea.style.transformOrigin="45% 25%"):(n=1,paintArea.style.transform="scale("+n+")",paintArea.style.transformOrigin="25% 25%"))}function loadPresetsFromJSON(t){$.getJSON(t,function(t){console.log("success")}).done(function(t){console.log("done"),console.log(t),canvas.loadFromJSON(t,canvas.renderAll.bind(canvas),function(t,e){if(console.log(t),console.log(e),"slider"===e.type){var n,r,a,i,o;!function(){var t=function s(t,e,n){t++,t===e.slides.length&&(t=0),new fabric.Image.fromURL(e.slides[t].src,function(t){t.setHeight(a.height),t.setWidth(a.width),a.setBackgroundImage(t),a.renderAll(),console.log(a.getElement()),i=new fabric.Pattern({source:a.getElement(),repeat:"no-repeat"}),e.setFill(i),canvas.renderAll()}),r=1e3*e.slides[t].continued,setTimeout(function(){s(t,e,n)},r)};n=0,a=e.patternSourceCanvas,i=e.pattern,r=1e3*e.slides[0].continued,o=e.id,setTimeout(function(){t(n,e,o)},r)}()}bindEvents(e)})}).fail(function(){console.log("error")})}function bindEvents(t){t.on("selected",function(){console.log("selected"),$(".objectControl").addClass("active"),"i-text"===t.type?($(".text-attr").show(),$(".basic-attr").hide()):($(".text-attr").hide(),$(".basic-attr").show()),$("#config").fadeIn("fast").promise().done(function(){$(this).fadeTo("fast",.9)}),instantMeta.log(t)}),canvas.on("before:selection:cleared",function(){console.log("deselected"),$(".objectControl").removeClass("active"),$("#config").fadeOut("fast"),instantMeta.clean()}),t.on("scaling",function(){console.log("scaling"),instantMeta.log(t)}),t.on("moving",function(){console.log("moving"),instantMeta.log(t)}),t.on("rotating",function(){console.log("rotating"),instantMeta.log(t)}),t.on("changed",function(){console.log("Exited"),instantMeta.log(t)})}function selectionConfirmator(t){if(t.length>1){console.log("an array");var e=canvas.getActiveObject();null==e?alert("未選取任何物件"):(void 0!==e._element&&"video"===e._element.localName?(e.getElement().pause(),e.remove()):e.remove(),Artboard.addMedia(t)),$("#mediaLibrary").removeClass("active")}else if(1===t.length){console.log("single");var e=canvas.getActiveObject();null==e?alert("未選取任何物件"):(void 0!==e._element&&"video"===e._element.localName?(e.getElement().pause(),e.remove()):e.remove(),Artboard.addMedia(t)),$("#mediaLibrary").removeClass("active")}}function logObj(){$("#console .shapeobj .content").html(JSON.stringify(canvas.toJSON())),$("#console .canvasobj .content").html(JSON.stringify(canvas))}(function(){function t(t){function e(e,n,r,a,i,o){for(;i>=0&&o>i;i+=t){var s=a?a[i]:i;r=n(r,e[s],s,e)}return r}return function(n,r,a,i){r=y(r,i,4);var o=!A(n)&&m.keys(n),s=(o||n).length,l=t>0?0:s-1;return arguments.length<3&&(a=n[o?o[l]:l],l+=t),e(n,r,a,o,l,s)}}function e(t){return function(e,n,r){n=w(n,r);for(var a=j(e),i=t>0?0:a-1;i>=0&&a>i;i+=t)if(n(e[i],i,e))return i;return-1}}function n(t,e,n){return function(r,a,i){var o=0,s=j(r);if("number"==typeof i)t>0?o=i>=0?i:Math.max(i+s,o):s=i>=0?Math.min(i+1,s):i+s+1;else if(n&&i&&s)return i=n(r,a),r[i]===a?i:-1;if(a!==a)return i=e(u.call(r,o,s),m.isNaN),i>=0?i+o:-1;for(i=t>0?o:s-1;i>=0&&s>i;i+=t)if(r[i]===a)return i;return-1}}function r(t,e){var n=D.length,r=t.constructor,a=m.isFunction(r)&&r.prototype||s,i="constructor";for(m.has(t,i)&&!m.contains(e,i)&&e.push(i);n--;)i=D[n],i in t&&t[i]!==a[i]&&!m.contains(e,i)&&e.push(i)}var a=this,i=a._,o=Array.prototype,s=Object.prototype,l=Function.prototype,c=o.push,u=o.slice,f=s.toString,d=s.hasOwnProperty,h=Array.isArray,p=Object.keys,g=l.bind,v=Object.create,b=function(){},m=function(t){return t instanceof m?t:this instanceof m?void(this._wrapped=t):new m(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=m),exports._=m):a._=m,m.VERSION="1.8.3";var y=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,a){return t.call(e,n,r,a)};case 4:return function(n,r,a,i){return t.call(e,n,r,a,i)}}return function(){return t.apply(e,arguments)}},w=function(t,e,n){return null==t?m.identity:m.isFunction(t)?y(t,e,n):m.isObject(t)?m.matcher(t):m.property(t)};m.iteratee=function(t,e){return w(t,e,1/0)};var _=function(t,e){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var a=1;r>a;a++)for(var i=arguments[a],o=t(i),s=o.length,l=0;s>l;l++){var c=o[l];e&&void 0!==n[c]||(n[c]=i[c])}return n}},x=function(t){if(!m.isObject(t))return{};if(v)return v(t);b.prototype=t;var e=new b;return b.prototype=null,e},k=function(t){return function(e){return null==e?void 0:e[t]}},S=Math.pow(2,53)-1,j=k("length"),A=function(t){var e=j(t);return"number"==typeof e&&e>=0&&S>=e};m.each=m.forEach=function(t,e,n){e=y(e,n);var r,a;if(A(t))for(r=0,a=t.length;a>r;r++)e(t[r],r,t);else{var i=m.keys(t);for(r=0,a=i.length;a>r;r++)e(t[i[r]],i[r],t)}return t},m.map=m.collect=function(t,e,n){e=w(e,n);for(var r=!A(t)&&m.keys(t),a=(r||t).length,i=Array(a),o=0;a>o;o++){var s=r?r[o]:o;i[o]=e(t[s],s,t)}return i},m.reduce=m.foldl=m.inject=t(1),m.reduceRight=m.foldr=t(-1),m.find=m.detect=function(t,e,n){var r;return r=A(t)?m.findIndex(t,e,n):m.findKey(t,e,n),void 0!==r&&-1!==r?t[r]:void 0},m.filter=m.select=function(t,e,n){var r=[];return e=w(e,n),m.each(t,function(t,n,a){e(t,n,a)&&r.push(t)}),r},m.reject=function(t,e,n){return m.filter(t,m.negate(w(e)),n)},m.every=m.all=function(t,e,n){e=w(e,n);for(var r=!A(t)&&m.keys(t),a=(r||t).length,i=0;a>i;i++){var o=r?r[i]:i;if(!e(t[o],o,t))return!1}return!0},m.some=m.any=function(t,e,n){e=w(e,n);for(var r=!A(t)&&m.keys(t),a=(r||t).length,i=0;a>i;i++){var o=r?r[i]:i;if(e(t[o],o,t))return!0}return!1},m.contains=m.includes=m.include=function(t,e,n,r){return A(t)||(t=m.values(t)),("number"!=typeof n||r)&&(n=0),m.indexOf(t,e,n)>=0},m.invoke=function(t,e){var n=u.call(arguments,2),r=m.isFunction(e);return m.map(t,function(t){var a=r?e:t[e];return null==a?a:a.apply(t,n)})},m.pluck=function(t,e){return m.map(t,m.property(e))},m.where=function(t,e){return m.filter(t,m.matcher(e))},m.findWhere=function(t,e){return m.find(t,m.matcher(e))},m.max=function(t,e,n){var r,a,i=-1/0,o=-1/0;if(null==e&&null!=t){t=A(t)?t:m.values(t);for(var s=0,l=t.length;l>s;s++)r=t[s],r>i&&(i=r)}else e=w(e,n),m.each(t,function(t,n,r){a=e(t,n,r),(a>o||a===-1/0&&i===-1/0)&&(i=t,o=a)});return i},m.min=function(t,e,n){var r,a,i=1/0,o=1/0;if(null==e&&null!=t){t=A(t)?t:m.values(t);for(var s=0,l=t.length;l>s;s++)r=t[s],i>r&&(i=r)}else e=w(e,n),m.each(t,function(t,n,r){a=e(t,n,r),(o>a||1/0===a&&1/0===i)&&(i=t,o=a)});return i},m.shuffle=function(t){for(var e,n=A(t)?t:m.values(t),r=n.length,a=Array(r),i=0;r>i;i++)e=m.random(0,i),e!==i&&(a[i]=a[e]),a[e]=n[i];return a},m.sample=function(t,e,n){return null==e||n?(A(t)||(t=m.values(t)),t[m.random(t.length-1)]):m.shuffle(t).slice(0,Math.max(0,e))},m.sortBy=function(t,e,n){return e=w(e,n),m.pluck(m.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var O=function(t){return function(e,n,r){var a={};return n=w(n,r),m.each(e,function(r,i){var o=n(r,i,e);t(a,r,o)}),a}};m.groupBy=O(function(t,e,n){m.has(t,n)?t[n].push(e):t[n]=[e]}),m.indexBy=O(function(t,e,n){t[n]=e}),m.countBy=O(function(t,e,n){m.has(t,n)?t[n]++:t[n]=1}),m.toArray=function(t){return t?m.isArray(t)?u.call(t):A(t)?m.map(t,m.identity):m.values(t):[]},m.size=function(t){return null==t?0:A(t)?t.length:m.keys(t).length},m.partition=function(t,e,n){e=w(e,n);var r=[],a=[];return m.each(t,function(t,n,i){(e(t,n,i)?r:a).push(t)}),[r,a]},m.first=m.head=m.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:m.initial(t,t.length-e)},m.initial=function(t,e,n){return u.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},m.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:m.rest(t,Math.max(0,t.length-e))},m.rest=m.tail=m.drop=function(t,e,n){return u.call(t,null==e||n?1:e)},m.compact=function(t){return m.filter(t,m.identity)};var C=function(t,e,n,r){for(var a=[],i=0,o=r||0,s=j(t);s>o;o++){var l=t[o];if(A(l)&&(m.isArray(l)||m.isArguments(l))){e||(l=C(l,e,n));var c=0,u=l.length;for(a.length+=u;u>c;)a[i++]=l[c++]}else n||(a[i++]=l)}return a};m.flatten=function(t,e){return C(t,e,!1)},m.without=function(t){return m.difference(t,u.call(arguments,1))},m.uniq=m.unique=function(t,e,n,r){m.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=w(n,r));for(var a=[],i=[],o=0,s=j(t);s>o;o++){var l=t[o],c=n?n(l,o,t):l;e?(o&&i===c||a.push(l),i=c):n?m.contains(i,c)||(i.push(c),a.push(l)):m.contains(a,l)||a.push(l)}return a},m.union=function(){return m.uniq(C(arguments,!0,!0))},m.intersection=function(t){for(var e=[],n=arguments.length,r=0,a=j(t);a>r;r++){var i=t[r];if(!m.contains(e,i)){for(var o=1;n>o&&m.contains(arguments[o],i);o++);o===n&&e.push(i)}}return e},m.difference=function(t){var e=C(arguments,!0,!0,1);return m.filter(t,function(t){return!m.contains(e,t)})},m.zip=function(){return m.unzip(arguments)},m.unzip=function(t){for(var e=t&&m.max(t,j).length||0,n=Array(e),r=0;e>r;r++)n[r]=m.pluck(t,r);return n},m.object=function(t,e){for(var n={},r=0,a=j(t);a>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},m.findIndex=e(1),m.findLastIndex=e(-1),m.sortedIndex=function(t,e,n,r){n=w(n,r,1);for(var a=n(e),i=0,o=j(t);o>i;){var s=Math.floor((i+o)/2);n(t[s])<a?i=s+1:o=s}return i},m.indexOf=n(1,m.findIndex,m.sortedIndex),m.lastIndexOf=n(-1,m.findLastIndex),m.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),a=Array(r),i=0;r>i;i++,t+=n)a[i]=t;return a};var T=function(t,e,n,r,a){if(!(r instanceof e))return t.apply(n,a);var i=x(t.prototype),o=t.apply(i,a);return m.isObject(o)?o:i};m.bind=function(t,e){if(g&&t.bind===g)return g.apply(t,u.call(arguments,1));if(!m.isFunction(t))throw new TypeError("Bind must be called on a function");var n=u.call(arguments,2),r=function(){return T(t,r,e,this,n.concat(u.call(arguments)))};return r},m.partial=function(t){var e=u.call(arguments,1),n=function(){for(var r=0,a=e.length,i=Array(a),o=0;a>o;o++)i[o]=e[o]===m?arguments[r++]:e[o];for(;r<arguments.length;)i.push(arguments[r++]);return T(t,n,this,this,i)};return n},m.bindAll=function(t){var e,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)n=arguments[e],t[n]=m.bind(t[n],t);return t},m.memoize=function(t,e){var n=function(r){var a=n.cache,i=""+(e?e.apply(this,arguments):r);return m.has(a,i)||(a[i]=t.apply(this,arguments)),a[i]};return n.cache={},n},m.delay=function(t,e){var n=u.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},m.defer=m.partial(m.delay,m,1),m.throttle=function(t,e,n){var r,a,i,o=null,s=0;n||(n={});var l=function(){s=n.leading===!1?0:m.now(),o=null,i=t.apply(r,a),o||(r=a=null)};return function(){var c=m.now();s||n.leading!==!1||(s=c);var u=e-(c-s);return r=this,a=arguments,0>=u||u>e?(o&&(clearTimeout(o),o=null),s=c,i=t.apply(r,a),o||(r=a=null)):o||n.trailing===!1||(o=setTimeout(l,u)),i}},m.debounce=function(t,e,n){var r,a,i,o,s,l=function(){var c=m.now()-o;e>c&&c>=0?r=setTimeout(l,e-c):(r=null,n||(s=t.apply(i,a),r||(i=a=null)))};return function(){i=this,a=arguments,o=m.now();var c=n&&!r;return r||(r=setTimeout(l,e)),c&&(s=t.apply(i,a),i=a=null),s}},m.wrap=function(t,e){return m.partial(e,t)},m.negate=function(t){return function(){return!t.apply(this,arguments)}},m.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},m.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},m.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},m.once=m.partial(m.before,2);var E=!{toString:null}.propertyIsEnumerable("toString"),D=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];m.keys=function(t){if(!m.isObject(t))return[];if(p)return p(t);var e=[];for(var n in t)m.has(t,n)&&e.push(n);return E&&r(t,e),e},m.allKeys=function(t){if(!m.isObject(t))return[];var e=[];for(var n in t)e.push(n);return E&&r(t,e),e},m.values=function(t){for(var e=m.keys(t),n=e.length,r=Array(n),a=0;n>a;a++)r[a]=t[e[a]];return r},m.mapObject=function(t,e,n){e=w(e,n);for(var r,a=m.keys(t),i=a.length,o={},s=0;i>s;s++)r=a[s],o[r]=e(t[r],r,t);return o},m.pairs=function(t){for(var e=m.keys(t),n=e.length,r=Array(n),a=0;n>a;a++)r[a]=[e[a],t[e[a]]];return r},m.invert=function(t){for(var e={},n=m.keys(t),r=0,a=n.length;a>r;r++)e[t[n[r]]]=n[r];return e},m.functions=m.methods=function(t){var e=[];for(var n in t)m.isFunction(t[n])&&e.push(n);return e.sort()},m.extend=_(m.allKeys),m.extendOwn=m.assign=_(m.keys),m.findKey=function(t,e,n){e=w(e,n);for(var r,a=m.keys(t),i=0,o=a.length;o>i;i++)if(r=a[i],e(t[r],r,t))return r},m.pick=function(t,e,n){var r,a,i={},o=t;if(null==o)return i;m.isFunction(e)?(a=m.allKeys(o),r=y(e,n)):(a=C(arguments,!1,!1,1),r=function(t,e,n){return e in n},o=Object(o));for(var s=0,l=a.length;l>s;s++){var c=a[s],u=o[c];r(u,c,o)&&(i[c]=u)}return i},m.omit=function(t,e,n){if(m.isFunction(e))e=m.negate(e);else{var r=m.map(C(arguments,!1,!1,1),String);e=function(t,e){return!m.contains(r,e)}}return m.pick(t,e,n)},m.defaults=_(m.allKeys,!0),m.create=function(t,e){var n=x(t);return e&&m.extendOwn(n,e),n},m.clone=function(t){return m.isObject(t)?m.isArray(t)?t.slice():m.extend({},t):t},m.tap=function(t,e){return e(t),t},m.isMatch=function(t,e){var n=m.keys(e),r=n.length;if(null==t)return!r;for(var a=Object(t),i=0;r>i;i++){var o=n[i];if(e[o]!==a[o]||!(o in a))return!1}return!0};var $=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof m&&(t=t._wrapped),e instanceof m&&(e=e._wrapped);var a=f.call(t);if(a!==f.call(e))return!1;switch(a){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var i="[object Array]"===a;if(!i){if("object"!=typeof t||"object"!=typeof e)return!1;var o=t.constructor,s=e.constructor;if(o!==s&&!(m.isFunction(o)&&o instanceof o&&m.isFunction(s)&&s instanceof s)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var l=n.length;l--;)if(n[l]===t)return r[l]===e;if(n.push(t),r.push(e),i){if(l=t.length,l!==e.length)return!1;for(;l--;)if(!$(t[l],e[l],n,r))return!1}else{var c,u=m.keys(t);if(l=u.length,m.keys(e).length!==l)return!1;for(;l--;)if(c=u[l],!m.has(e,c)||!$(t[c],e[c],n,r))return!1}return n.pop(),r.pop(),!0};m.isEqual=function(t,e){return $(t,e)},m.isEmpty=function(t){return null==t?!0:A(t)&&(m.isArray(t)||m.isString(t)||m.isArguments(t))?0===t.length:0===m.keys(t).length},m.isElement=function(t){return!(!t||1!==t.nodeType)},m.isArray=h||function(t){return"[object Array]"===f.call(t)},m.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},m.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){m["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),m.isArguments(arguments)||(m.isArguments=function(t){return m.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(m.isFunction=function(t){return"function"==typeof t||!1}),m.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},m.isNaN=function(t){return m.isNumber(t)&&t!==+t},m.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},m.isNull=function(t){return null===t},m.isUndefined=function(t){return void 0===t},m.has=function(t,e){return null!=t&&d.call(t,e)},m.noConflict=function(){return a._=i,this},m.identity=function(t){return t},m.constant=function(t){return function(){return t}},m.noop=function(){},m.property=k,m.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},m.matcher=m.matches=function(t){return t=m.extendOwn({},t),function(e){return m.isMatch(e,t)}},m.times=function(t,e,n){var r=Array(Math.max(0,t));e=y(e,n,1);for(var a=0;t>a;a++)r[a]=e(a);return r},m.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},m.now=Date.now||function(){return(new Date).getTime()};var M={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},P=m.invert(M),F=function(t){var e=function(e){return t[e]},n="(?:"+m.keys(t).join("|")+")",r=RegExp(n),a=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(a,e):t}};m.escape=F(M),m.unescape=F(P),m.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),m.isFunction(r)?r.call(t):r};var R=0;m.uniqueId=function(t){var e=++R+"";return t?t+e:e},m.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var N=/(.)^/,I={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},Y=/\\|'|\r|\n|\u2028|\u2029/g,H=function(t){return"\\"+I[t]};m.template=function(t,e,n){!e&&n&&(e=n),e=m.defaults({},e,m.templateSettings);var r=RegExp([(e.escape||N).source,(e.interpolate||N).source,(e.evaluate||N).source].join("|")+"|$","g"),a=0,i="__p+='";t.replace(r,function(e,n,r,o,s){return i+=t.slice(a,s).replace(Y,H),a=s+e.length,n?i+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?i+="'+\n((__t=("+r+"))==null?'':__t)+\n'":o&&(i+="';\n"+o+"\n__p+='"),e}),i+="';\n",e.variable||(i="with(obj||{}){\n"+i+"}\n"),i="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+i+"return __p;\n";try{var o=new Function(e.variable||"obj","_",i)}catch(s){throw s.source=i,s}var l=function(t){return o.call(this,t,m)},c=e.variable||"obj";return l.source="function("+c+"){\n"+i+"}",l},m.chain=function(t){var e=m(t);return e._chain=!0,e};var X=function(t,e){return t._chain?m(e).chain():e};m.mixin=function(t){m.each(m.functions(t),function(e){var n=m[e]=t[e];m.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),X(this,n.apply(m,t))}})},m.mixin(m),m.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=o[t];m.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],X(this,n)}}),m.each(["concat","join","slice"],function(t){var e=o[t];m.prototype[t]=function(){return X(this,e.apply(this._wrapped,arguments))}}),m.prototype.value=function(){return this._wrapped},m.prototype.valueOf=m.prototype.toJSON=m.prototype.value,m.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return m})}).call(this);var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){"use strict";"function"==typeof define&&define.amd?define(["jquery"],t):"object"==("undefined"==typeof exports?"undefined":_typeof(exports))&&"object"==("undefined"==typeof module?"undefined":_typeof(module))?module.exports=t(require("jquery")):t(jQuery)}(function(t,e){"use strict";function n(e,n,r,a){for(var i=[],o=0;o<e.length;o++){var s=e[o];if(s){var l=tinycolor(s),c=l.toHsl().l<.5?"sp-thumb-el sp-thumb-dark":"sp-thumb-el sp-thumb-light";c+=tinycolor.equals(n,s)?" sp-thumb-active":"";var u=l.toString(a.preferredFormat||"rgb"),f=v?"background-color:"+l.toRgbString():"filter:"+l.toFilter();i.push('<span title="'+u+'" data-color="'+l.toRgbString()+'" class="'+c+'"><span class="sp-thumb-inner" style="'+f+';" /></span>')}else{var d="sp-clear-display";i.push(t("<div />").append(t('<span data-color="" style="background-color:transparent;" class="'+d+'"></span>').attr("title",a.noColorSelectedText)).html())}}return"<div class='sp-cf "+r+"'>"+i.join("")+"</div>"}function r(){for(var t=0;t<p.length;t++)p[t]&&p[t].hide()}function a(e,n){var r=t.extend({},h,e);return r.callbacks={move:c(r.move,n),change:c(r.change,n),show:c(r.show,n),hide:c(r.hide,n),beforeShow:c(r.beforeShow,n)},r}function i(i,s){function c(){if(q.showPaletteOnly&&(q.showPalette=!0),It.text(q.showPaletteOnly?q.togglePaletteMoreText:q.togglePaletteLessText),q.palette){ht=q.palette.slice(0),pt=t.isArray(ht[0])?ht:[ht],gt={};for(var e=0;e<pt.length;e++)for(var n=0;n<pt[e].length;n++){var r=tinycolor(pt[e][n]).toRgbString();gt[r]=!0}}kt.toggleClass("sp-flat",G),kt.toggleClass("sp-input-disabled",!q.showInput),kt.toggleClass("sp-alpha-enabled",q.showAlpha),kt.toggleClass("sp-clear-enabled",Kt),kt.toggleClass("sp-buttons-disabled",!q.showButtons),kt.toggleClass("sp-palette-buttons-disabled",!q.togglePaletteOnly),kt.toggleClass("sp-palette-disabled",!q.showPalette),kt.toggleClass("sp-palette-only",q.showPaletteOnly),kt.toggleClass("sp-initial-disabled",!q.showInitial),kt.addClass(q.className).addClass(q.containerClassName),H()}function h(){function e(e){return e.data&&e.data.ignore?(M(t(e.target).closest(".sp-thumb-el").data("color")),R()):(M(t(e.target).closest(".sp-thumb-el").data("color")),R(),Y(!0),q.hideAfterPaletteSelect&&D()),!1}if(g&&kt.find("*:not(input)").attr("unselectable","on"),c(),Xt&&_t.after(Bt).hide(),Kt||Rt.hide(),G)_t.after(kt).hide();else{var n="parent"===q.appendTo?_t.parent():t(q.appendTo);1!==n.length&&(n=t("body")),n.append(kt)}y(),Lt.bind("click.spectrum touchstart.spectrum",function(e){xt||O(),e.stopPropagation(),t(e.target).is("input")||e.preventDefault()}),(_t.is(":disabled")||q.disabled===!0)&&z(),kt.click(l),$t.change(A),$t.bind("paste",function(){setTimeout(A,1)}),$t.keydown(function(t){13==t.keyCode&&A()}),Ft.text(q.cancelText),Ft.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),$(),D()}),Rt.attr("title",q.clearText),Rt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),Ut=!0,R(),G&&Y(!0)}),Nt.text(q.chooseText),Nt.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),g&&$t.is(":focus")&&$t.trigger("change"),F()&&(Y(!0),D())}),It.text(q.showPaletteOnly?q.togglePaletteMoreText:q.togglePaletteLessText),It.bind("click.spectrum",function(t){t.stopPropagation(),t.preventDefault(),q.showPaletteOnly=!q.showPaletteOnly,q.showPaletteOnly||G||kt.css("left","-="+(St.outerWidth(!0)+5)),c()}),u(Et,function(t,e,n){dt=t/ot,Ut=!1,n.shiftKey&&(dt=Math.round(10*dt)/10),R()},S,j),u(Ot,function(t,e){ct=parseFloat(e/at),Ut=!1,q.showAlpha||(dt=1),R()},S,j),u(jt,function(t,e,n){if(n.shiftKey){if(!yt){var r=ut*et,a=nt-ft*nt,i=Math.abs(t-r)>Math.abs(e-a);yt=i?"x":"y"}}else yt=null;var o=!yt||"x"===yt,s=!yt||"y"===yt;o&&(ut=parseFloat(t/et)),s&&(ft=parseFloat((nt-e)/nt)),Ut=!1,q.showAlpha||(dt=1),R()},S,j),Wt?(M(Wt),N(),Gt=q.preferredFormat||tinycolor(Wt).format,w(Wt)):N(),G&&C();var r=g?"mousedown.spectrum":"click.spectrum touchstart.spectrum";Mt.delegate(".sp-thumb-el",r,e),Pt.delegate(".sp-thumb-el:nth-child(1)",r,{ignore:!0},e)}function y(){if(U&&window.localStorage){try{var e=window.localStorage[U].split(",#");e.length>1&&(delete window.localStorage[U],t.each(e,function(t,e){w(e)}))}catch(n){}try{vt=window.localStorage[U].split(";")}catch(n){}}}function w(e){if(V){var n=tinycolor(e).toRgbString();if(!gt[n]&&-1===t.inArray(n,vt))for(vt.push(n);vt.length>bt;)vt.shift();if(U&&window.localStorage)try{window.localStorage[U]=vt.join(";")}catch(r){}}}function _(){var t=[];if(q.showPalette)for(var e=0;e<vt.length;e++){var n=tinycolor(vt[e]).toRgbString();gt[n]||t.push(vt[e])}return t.reverse().slice(0,q.maxSelectionSize)}function x(){var e=P(),r=t.map(pt,function(t,r){return n(t,e,"sp-palette-row sp-palette-row-"+r,q)});y(),vt&&r.push(n(_(),e,"sp-palette-row sp-palette-row-selection",q)),Mt.html(r.join(""))}function k(){if(q.showInitial){var t=qt,e=P();Pt.html(n([t,e],e,"sp-palette-row-initial",q))}}function S(){(0>=nt||0>=et||0>=at)&&H(),tt=!0,kt.addClass(mt),yt=null,_t.trigger("dragstart.spectrum",[P()])}function j(){tt=!1,kt.removeClass(mt),_t.trigger("dragstop.spectrum",[P()])}function A(){var t=$t.val();if(null!==t&&""!==t||!Kt){var e=tinycolor(t);e.isValid()?(M(e),Y(!0)):$t.addClass("sp-validation-error")}else M(null),Y(!0)}function O(){Z?D():C()}function C(){var e=t.Event("beforeShow.spectrum");return Z?void H():(_t.trigger(e,[P()]),void(J.beforeShow(P())===!1||e.isDefaultPrevented()||(r(),Z=!0,t(wt).bind("keydown.spectrum",T),t(wt).bind("click.spectrum",E),t(window).bind("resize.spectrum",Q),Bt.addClass("sp-active"),kt.removeClass("sp-hidden"),H(),N(),qt=P(),k(),J.show(qt),_t.trigger("show.spectrum",[qt]))))}function T(t){27===t.keyCode&&D()}function E(t){2!=t.button&&(tt||(Vt?Y(!0):$(),D()))}function D(){Z&&!G&&(Z=!1,t(wt).unbind("keydown.spectrum",T),t(wt).unbind("click.spectrum",E),t(window).unbind("resize.spectrum",Q),Bt.removeClass("sp-active"),kt.addClass("sp-hidden"),J.hide(P()),_t.trigger("hide.spectrum",[P()]))}function $(){M(qt,!0)}function M(t,e){if(tinycolor.equals(t,P()))return void N();var n,r;!t&&Kt?Ut=!0:(Ut=!1,n=tinycolor(t),r=n.toHsv(),ct=r.h%360/360,ut=r.s,ft=r.v,dt=r.a),N(),n&&n.isValid()&&!e&&(Gt=q.preferredFormat||n.getFormat())}function P(t){return t=t||{},Kt&&Ut?null:tinycolor.fromRatio({h:ct,s:ut,v:ft,a:Math.round(100*dt)/100},{format:t.format||Gt})}function F(){return!$t.hasClass("sp-validation-error")}function R(){N(),J.move(P()),_t.trigger("move.spectrum",[P()])}function N(){$t.removeClass("sp-validation-error"),I();var t=tinycolor.fromRatio({h:ct,s:1,v:1});jt.css("background-color",t.toHexString());var e=Gt;1>dt&&(0!==dt||"name"!==e)&&("hex"===e||"hex3"===e||"hex6"===e||"name"===e)&&(e="rgb");var n=P({format:e}),r="";if(zt.removeClass("sp-clear-display"),zt.css("background-color","transparent"),!n&&Kt)zt.addClass("sp-clear-display");else{var a=n.toHexString(),i=n.toRgbString();if(v||1===n.alpha?zt.css("background-color",i):(zt.css("background-color","transparent"),zt.css("filter",n.toFilter())),q.showAlpha){var o=n.toRgb();o.a=0;var s=tinycolor(o).toRgbString(),l="linear-gradient(left, "+s+", "+a+")";g?Tt.css("filter",tinycolor(s).toFilter({gradientType:1},a)):(Tt.css("background","-webkit-"+l),Tt.css("background","-moz-"+l),Tt.css("background","-ms-"+l),Tt.css("background","linear-gradient(to right, "+s+", "+a+")"))}r=n.toString(e)}q.showInput&&$t.val(r),q.showPalette&&x(),k()}function I(){var t=ut,e=ft;if(Kt&&Ut)Dt.hide(),Ct.hide(),At.hide();else{Dt.show(),Ct.show(),At.show();var n=t*et,r=nt-e*nt;n=Math.max(-rt,Math.min(et-rt,n-rt)),r=Math.max(-rt,Math.min(nt-rt,r-rt)),At.css({top:r+"px",left:n+"px"});var a=dt*ot;Dt.css({left:a-st/2+"px"});var i=ct*at;Ct.css({top:i-lt+"px"})}}function Y(t){var e=P(),n="",r=!tinycolor.equals(e,qt);e&&(n=e.toString(Gt),w(e)),Yt&&_t.val(n),t&&r&&(J.change(e),_t.trigger("change",[e]))}function H(){Z&&(et=jt.width(),nt=jt.height(),rt=At.height(),it=Ot.width(),at=Ot.height(),lt=Ct.height(),ot=Et.width(),st=Dt.width(),G||(kt.css("position","absolute"),q.offset?kt.offset(q.offset):kt.offset(o(kt,Lt))),I(),q.showPalette&&x(),_t.trigger("reflow.spectrum"))}function X(){_t.show(),Lt.unbind("click.spectrum touchstart.spectrum"),kt.remove(),Bt.remove(),p[Jt.id]=null}function B(n,r){return n===e?t.extend({},q):r===e?q[n]:(q[n]=r,"preferredFormat"===n&&(Gt=q.preferredFormat),void c())}function L(){xt=!1,_t.attr("disabled",!1),Lt.removeClass("sp-disabled")}function z(){D(),xt=!0,_t.attr("disabled",!0),Lt.addClass("sp-disabled")}function W(t){q.offset=t,H()}var q=a(s,i),G=q.flat,V=q.showSelectionPalette,U=q.localStorageKey,K=q.theme,J=q.callbacks,Q=f(H,10),Z=!1,tt=!1,et=0,nt=0,rt=0,at=0,it=0,ot=0,st=0,lt=0,ct=0,ut=0,ft=0,dt=1,ht=[],pt=[],gt={},vt=q.selectionPalette.slice(0),bt=q.maxSelectionSize,mt="sp-dragging",yt=null,wt=i.ownerDocument,_t=(wt.body,t(i)),xt=!1,kt=t(m,wt).addClass(K),St=kt.find(".sp-picker-container"),jt=kt.find(".sp-color"),At=kt.find(".sp-dragger"),Ot=kt.find(".sp-hue"),Ct=kt.find(".sp-slider"),Tt=kt.find(".sp-alpha-inner"),Et=kt.find(".sp-alpha"),Dt=kt.find(".sp-alpha-handle"),$t=kt.find(".sp-input"),Mt=kt.find(".sp-palette"),Pt=kt.find(".sp-initial"),Ft=kt.find(".sp-cancel"),Rt=kt.find(".sp-clear"),Nt=kt.find(".sp-choose"),It=kt.find(".sp-palette-toggle"),Yt=_t.is("input"),Ht=Yt&&"color"===_t.attr("type")&&d(),Xt=Yt&&!G,Bt=Xt?t(b).addClass(K).addClass(q.className).addClass(q.replacerClassName):t([]),Lt=Xt?Bt:_t,zt=Bt.find(".sp-preview-inner"),Wt=q.color||Yt&&_t.val(),qt=!1,Gt=q.preferredFormat,Vt=!q.showButtons||q.clickoutFiresChange,Ut=!Wt,Kt=q.allowEmpty&&!Ht;
h();var Jt={show:C,hide:D,toggle:O,reflow:H,option:B,enable:L,disable:z,offset:W,set:function(t){M(t),Y()},get:P,destroy:X,container:kt};return Jt.id=p.push(Jt)-1,Jt}function o(e,n){var r=0,a=e.outerWidth(),i=e.outerHeight(),o=n.outerHeight(),s=e[0].ownerDocument,l=s.documentElement,c=l.clientWidth+t(s).scrollLeft(),u=l.clientHeight+t(s).scrollTop(),f=n.offset();return f.top+=o,f.left-=Math.min(f.left,f.left+a>c&&c>a?Math.abs(f.left+a-c):0),f.top-=Math.min(f.top,f.top+i>u&&u>i?Math.abs(i+o-r):r),f}function s(){}function l(t){t.stopPropagation()}function c(t,e){var n=Array.prototype.slice,r=n.call(arguments,2);return function(){return t.apply(e,r.concat(n.call(arguments)))}}function u(e,n,r,a){function i(t){t.stopPropagation&&t.stopPropagation(),t.preventDefault&&t.preventDefault(),t.returnValue=!1}function o(t){if(u){if(g&&c.documentMode<9&&!t.button)return l();var r=t.originalEvent&&t.originalEvent.touches&&t.originalEvent.touches[0],a=r&&r.pageX||t.pageX,o=r&&r.pageY||t.pageY,s=Math.max(0,Math.min(a-f.left,h)),v=Math.max(0,Math.min(o-f.top,d));p&&i(t),n.apply(e,[s,v,t])}}function s(n){var a=n.which?3==n.which:2==n.button;a||u||r.apply(e,arguments)!==!1&&(u=!0,d=t(e).height(),h=t(e).width(),f=t(e).offset(),t(c).bind(v),t(c.body).addClass("sp-dragging"),o(n),i(n))}function l(){u&&(t(c).unbind(v),t(c.body).removeClass("sp-dragging"),setTimeout(function(){a.apply(e,arguments)},0)),u=!1}n=n||function(){},r=r||function(){},a=a||function(){};var c=document,u=!1,f={},d=0,h=0,p="ontouchstart"in window,v={};v.selectstart=i,v.dragstart=i,v["touchmove mousemove"]=o,v["touchend mouseup"]=l,t(e).bind("touchstart mousedown",s)}function f(t,e,n){var r;return function(){var a=this,i=arguments,o=function(){r=null,t.apply(a,i)};n&&clearTimeout(r),(n||!r)&&(r=setTimeout(o,e))}}function d(){return t.fn.spectrum.inputTypeColorSupport()}var h={beforeShow:s,move:s,change:s,show:s,hide:s,color:!1,flat:!1,showInput:!1,allowEmpty:!1,showButtons:!0,clickoutFiresChange:!0,showInitial:!1,showPalette:!1,showPaletteOnly:!1,hideAfterPaletteSelect:!1,togglePaletteOnly:!1,showSelectionPalette:!0,localStorageKey:!1,appendTo:"body",maxSelectionSize:7,cancelText:"cancel",chooseText:"choose",togglePaletteMoreText:"more",togglePaletteLessText:"less",clearText:"Clear Color Selection",noColorSelectedText:"No Color Selected",preferredFormat:!1,className:"",containerClassName:"",replacerClassName:"",showAlpha:!1,theme:"sp-light",palette:[["#ffffff","#000000","#ff0000","#ff8000","#ffff00","#008000","#0000ff","#4b0082","#9400d3"]],selectionPalette:[],disabled:!1,offset:null},p=[],g=!!/msie/i.exec(window.navigator.userAgent),v=function(){function t(t,e){return!!~(""+t).indexOf(e)}var e=document.createElement("div"),n=e.style;return n.cssText="background-color:rgba(0,0,0,.5)",t(n.backgroundColor,"rgba")||t(n.backgroundColor,"hsla")}(),b=["<div class='sp-replacer'>","<div class='sp-preview'><div class='sp-preview-inner'></div></div>","<div class='sp-dd'>&#9660;</div>","</div>"].join(""),m=function(){var t="";if(g)for(var e=1;6>=e;e++)t+="<div class='sp-"+e+"'></div>";return["<div class='sp-container sp-hidden'>","<div class='sp-palette-container'>","<div class='sp-palette sp-thumb sp-cf'></div>","<div class='sp-palette-button-container sp-cf'>","<button type='button' class='sp-palette-toggle'></button>","</div>","</div>","<div class='sp-picker-container'>","<div class='sp-top sp-cf'>","<div class='sp-fill'></div>","<div class='sp-top-inner'>","<div class='sp-color'>","<div class='sp-sat'>","<div class='sp-val'>","<div class='sp-dragger'></div>","</div>","</div>","</div>","<div class='sp-clear sp-clear-display'>","</div>","<div class='sp-hue'>","<div class='sp-slider'></div>",t,"</div>","</div>","<div class='sp-alpha'><div class='sp-alpha-inner'><div class='sp-alpha-handle'></div></div></div>","</div>","<div class='sp-input-container sp-cf'>","<input class='sp-input' type='text' spellcheck='false'  />","</div>","<div class='sp-initial sp-thumb sp-cf'></div>","<div class='sp-button-container sp-cf'>","<a class='sp-cancel' href='#'></a>","<button type='button' class='sp-choose'></button>","</div>","</div>","</div>"].join("")}(),y="spectrum.id";t.fn.spectrum=function(e,n){if("string"==typeof e){var r=this,a=Array.prototype.slice.call(arguments,1);return this.each(function(){var n=p[t(this).data(y)];if(n){var i=n[e];if(!i)throw new Error("Spectrum: no such method: '"+e+"'");"get"==e?r=n.get():"container"==e?r=n.container:"option"==e?r=n.option.apply(n,a):"destroy"==e?(n.destroy(),t(this).removeData(y)):i.apply(n,a)}}),r}return this.spectrum("destroy").each(function(){var n=t.extend({},e,t(this).data()),r=i(this,n);t(this).data(y,r.id)})},t.fn.spectrum.load=!0,t.fn.spectrum.loadOpts={},t.fn.spectrum.draggable=u,t.fn.spectrum.defaults=h,t.fn.spectrum.inputTypeColorSupport=function w(){if("undefined"==typeof w._cachedResult){var e=t("<input type='color'/>")[0];w._cachedResult="color"===e.type&&""!==e.value}return w._cachedResult},t.spectrum={},t.spectrum.localization={},t.spectrum.palettes={},t.fn.spectrum.processNativeColorInputs=function(){var e=t("input[type=color]");e.length&&!d()&&e.spectrum({preferredFormat:"hex6"})},function(){function t(t){var n={r:0,g:0,b:0},a=1,o=!1,s=!1;return"string"==typeof t&&(t=$(t)),"object"==("undefined"==typeof t?"undefined":_typeof(t))&&(t.hasOwnProperty("r")&&t.hasOwnProperty("g")&&t.hasOwnProperty("b")?(n=e(t.r,t.g,t.b),o=!0,s="%"===String(t.r).substr(-1)?"prgb":"rgb"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("v")?(t.s=T(t.s),t.v=T(t.v),n=i(t.h,t.s,t.v),o=!0,s="hsv"):t.hasOwnProperty("h")&&t.hasOwnProperty("s")&&t.hasOwnProperty("l")&&(t.s=T(t.s),t.l=T(t.l),n=r(t.h,t.s,t.l),o=!0,s="hsl"),t.hasOwnProperty("a")&&(a=t.a)),a=x(a),{ok:o,format:t.format||s,r:I(255,Y(n.r,0)),g:I(255,Y(n.g,0)),b:I(255,Y(n.b,0)),a:a}}function e(t,e,n){return{r:255*k(t,255),g:255*k(e,255),b:255*k(n,255)}}function n(t,e,n){t=k(t,255),e=k(e,255),n=k(n,255);var r,a,i=Y(t,e,n),o=I(t,e,n),s=(i+o)/2;if(i==o)r=a=0;else{var l=i-o;switch(a=s>.5?l/(2-i-o):l/(i+o),i){case t:r=(e-n)/l+(n>e?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:a,l:s}}function r(t,e,n){function r(t,e,n){return 0>n&&(n+=1),n>1&&(n-=1),1/6>n?t+6*(e-t)*n:.5>n?e:2/3>n?t+(e-t)*(2/3-n)*6:t}var a,i,o;if(t=k(t,360),e=k(e,100),n=k(n,100),0===e)a=i=o=n;else{var s=.5>n?n*(1+e):n+e-n*e,l=2*n-s;a=r(l,s,t+1/3),i=r(l,s,t),o=r(l,s,t-1/3)}return{r:255*a,g:255*i,b:255*o}}function a(t,e,n){t=k(t,255),e=k(e,255),n=k(n,255);var r,a,i=Y(t,e,n),o=I(t,e,n),s=i,l=i-o;if(a=0===i?0:l/i,i==o)r=0;else{switch(i){case t:r=(e-n)/l+(n>e?6:0);break;case e:r=(n-t)/l+2;break;case n:r=(t-e)/l+4}r/=6}return{h:r,s:a,v:s}}function i(t,e,n){t=6*k(t,360),e=k(e,100),n=k(n,100);var r=R.floor(t),a=t-r,i=n*(1-e),o=n*(1-a*e),s=n*(1-(1-a)*e),l=r%6,c=[n,o,i,i,s,n][l],u=[s,n,n,o,i,i][l],f=[i,i,s,n,n,o][l];return{r:255*c,g:255*u,b:255*f}}function o(t,e,n,r){var a=[C(N(t).toString(16)),C(N(e).toString(16)),C(N(n).toString(16))];return r&&a[0].charAt(0)==a[0].charAt(1)&&a[1].charAt(0)==a[1].charAt(1)&&a[2].charAt(0)==a[2].charAt(1)?a[0].charAt(0)+a[1].charAt(0)+a[2].charAt(0):a.join("")}function s(t,e,n,r){var a=[C(E(r)),C(N(t).toString(16)),C(N(e).toString(16)),C(N(n).toString(16))];return a.join("")}function l(t,e){e=0===e?0:e||10;var n=X(t).toHsl();return n.s-=e/100,n.s=S(n.s),X(n)}function c(t,e){e=0===e?0:e||10;var n=X(t).toHsl();return n.s+=e/100,n.s=S(n.s),X(n)}function u(t){return X(t).desaturate(100)}function f(t,e){e=0===e?0:e||10;var n=X(t).toHsl();return n.l+=e/100,n.l=S(n.l),X(n)}function d(t,e){e=0===e?0:e||10;var n=X(t).toRgb();return n.r=Y(0,I(255,n.r-N(255*-(e/100)))),n.g=Y(0,I(255,n.g-N(255*-(e/100)))),n.b=Y(0,I(255,n.b-N(255*-(e/100)))),X(n)}function h(t,e){e=0===e?0:e||10;var n=X(t).toHsl();return n.l-=e/100,n.l=S(n.l),X(n)}function p(t,e){var n=X(t).toHsl(),r=(N(n.h)+e)%360;return n.h=0>r?360+r:r,X(n)}function g(t){var e=X(t).toHsl();return e.h=(e.h+180)%360,X(e)}function v(t){var e=X(t).toHsl(),n=e.h;return[X(t),X({h:(n+120)%360,s:e.s,l:e.l}),X({h:(n+240)%360,s:e.s,l:e.l})]}function b(t){var e=X(t).toHsl(),n=e.h;return[X(t),X({h:(n+90)%360,s:e.s,l:e.l}),X({h:(n+180)%360,s:e.s,l:e.l}),X({h:(n+270)%360,s:e.s,l:e.l})]}function m(t){var e=X(t).toHsl(),n=e.h;return[X(t),X({h:(n+72)%360,s:e.s,l:e.l}),X({h:(n+216)%360,s:e.s,l:e.l})]}function y(t,e,n){e=e||6,n=n||30;var r=X(t).toHsl(),a=360/n,i=[X(t)];for(r.h=(r.h-(a*e>>1)+720)%360;--e;)r.h=(r.h+a)%360,i.push(X(r));return i}function w(t,e){e=e||6;for(var n=X(t).toHsv(),r=n.h,a=n.s,i=n.v,o=[],s=1/e;e--;)o.push(X({h:r,s:a,v:i})),i=(i+s)%1;return o}function _(t){var e={};for(var n in t)t.hasOwnProperty(n)&&(e[t[n]]=n);return e}function x(t){return t=parseFloat(t),(isNaN(t)||0>t||t>1)&&(t=1),t}function k(t,e){A(t)&&(t="100%");var n=O(t);return t=I(e,Y(0,parseFloat(t))),n&&(t=parseInt(t*e,10)/100),R.abs(t-e)<1e-6?1:t%e/parseFloat(e)}function S(t){return I(1,Y(0,t))}function j(t){return parseInt(t,16)}function A(t){return"string"==typeof t&&-1!=t.indexOf(".")&&1===parseFloat(t)}function O(t){return"string"==typeof t&&-1!=t.indexOf("%")}function C(t){return 1==t.length?"0"+t:""+t}function T(t){return 1>=t&&(t=100*t+"%"),t}function E(t){return Math.round(255*parseFloat(t)).toString(16)}function D(t){return j(t)/255}function $(t){t=t.replace(M,"").replace(P,"").toLowerCase();var e=!1;if(B[t])t=B[t],e=!0;else if("transparent"==t)return{r:0,g:0,b:0,a:0,format:"name"};var n;return(n=z.rgb.exec(t))?{r:n[1],g:n[2],b:n[3]}:(n=z.rgba.exec(t))?{r:n[1],g:n[2],b:n[3],a:n[4]}:(n=z.hsl.exec(t))?{h:n[1],s:n[2],l:n[3]}:(n=z.hsla.exec(t))?{h:n[1],s:n[2],l:n[3],a:n[4]}:(n=z.hsv.exec(t))?{h:n[1],s:n[2],v:n[3]}:(n=z.hsva.exec(t))?{h:n[1],s:n[2],v:n[3],a:n[4]}:(n=z.hex8.exec(t))?{a:D(n[1]),r:j(n[2]),g:j(n[3]),b:j(n[4]),format:e?"name":"hex8"}:(n=z.hex6.exec(t))?{r:j(n[1]),g:j(n[2]),b:j(n[3]),format:e?"name":"hex"}:(n=z.hex3.exec(t))?{r:j(n[1]+""+n[1]),g:j(n[2]+""+n[2]),b:j(n[3]+""+n[3]),format:e?"name":"hex"}:!1}var M=/^[\s,#]+/,P=/\s+$/,F=0,R=Math,N=R.round,I=R.min,Y=R.max,H=R.random,X=function W(e,n){if(e=e?e:"",n=n||{},e instanceof W)return e;if(!(this instanceof W))return new W(e,n);var r=t(e);this._originalInput=e,this._r=r.r,this._g=r.g,this._b=r.b,this._a=r.a,this._roundA=N(100*this._a)/100,this._format=n.format||r.format,this._gradientType=n.gradientType,this._r<1&&(this._r=N(this._r)),this._g<1&&(this._g=N(this._g)),this._b<1&&(this._b=N(this._b)),this._ok=r.ok,this._tc_id=F++};X.prototype={isDark:function(){return this.getBrightness()<128},isLight:function(){return!this.isDark()},isValid:function(){return this._ok},getOriginalInput:function(){return this._originalInput},getFormat:function(){return this._format},getAlpha:function(){return this._a},getBrightness:function(){var t=this.toRgb();return(299*t.r+587*t.g+114*t.b)/1e3},setAlpha:function(t){return this._a=x(t),this._roundA=N(100*this._a)/100,this},toHsv:function(){var t=a(this._r,this._g,this._b);return{h:360*t.h,s:t.s,v:t.v,a:this._a}},toHsvString:function(){var t=a(this._r,this._g,this._b),e=N(360*t.h),n=N(100*t.s),r=N(100*t.v);return 1==this._a?"hsv("+e+", "+n+"%, "+r+"%)":"hsva("+e+", "+n+"%, "+r+"%, "+this._roundA+")"},toHsl:function(){var t=n(this._r,this._g,this._b);return{h:360*t.h,s:t.s,l:t.l,a:this._a}},toHslString:function(){var t=n(this._r,this._g,this._b),e=N(360*t.h),r=N(100*t.s),a=N(100*t.l);return 1==this._a?"hsl("+e+", "+r+"%, "+a+"%)":"hsla("+e+", "+r+"%, "+a+"%, "+this._roundA+")"},toHex:function(t){return o(this._r,this._g,this._b,t)},toHexString:function(t){return"#"+this.toHex(t)},toHex8:function(){return s(this._r,this._g,this._b,this._a)},toHex8String:function(){return"#"+this.toHex8()},toRgb:function(){return{r:N(this._r),g:N(this._g),b:N(this._b),a:this._a}},toRgbString:function(){return 1==this._a?"rgb("+N(this._r)+", "+N(this._g)+", "+N(this._b)+")":"rgba("+N(this._r)+", "+N(this._g)+", "+N(this._b)+", "+this._roundA+")"},toPercentageRgb:function(){return{r:N(100*k(this._r,255))+"%",g:N(100*k(this._g,255))+"%",b:N(100*k(this._b,255))+"%",a:this._a}},toPercentageRgbString:function(){return 1==this._a?"rgb("+N(100*k(this._r,255))+"%, "+N(100*k(this._g,255))+"%, "+N(100*k(this._b,255))+"%)":"rgba("+N(100*k(this._r,255))+"%, "+N(100*k(this._g,255))+"%, "+N(100*k(this._b,255))+"%, "+this._roundA+")"},toName:function(){return 0===this._a?"transparent":this._a<1?!1:L[o(this._r,this._g,this._b,!0)]||!1},toFilter:function(t){var e="#"+s(this._r,this._g,this._b,this._a),n=e,r=this._gradientType?"GradientType = 1, ":"";if(t){var a=X(t);n=a.toHex8String()}return"progid:DXImageTransform.Microsoft.gradient("+r+"startColorstr="+e+",endColorstr="+n+")"},toString:function(t){var e=!!t;t=t||this._format;var n=!1,r=this._a<1&&this._a>=0,a=!e&&r&&("hex"===t||"hex6"===t||"hex3"===t||"name"===t);return a?"name"===t&&0===this._a?this.toName():this.toRgbString():("rgb"===t&&(n=this.toRgbString()),"prgb"===t&&(n=this.toPercentageRgbString()),("hex"===t||"hex6"===t)&&(n=this.toHexString()),"hex3"===t&&(n=this.toHexString(!0)),"hex8"===t&&(n=this.toHex8String()),"name"===t&&(n=this.toName()),"hsl"===t&&(n=this.toHslString()),"hsv"===t&&(n=this.toHsvString()),n||this.toHexString())},_applyModification:function(t,e){var n=t.apply(null,[this].concat([].slice.call(e)));return this._r=n._r,this._g=n._g,this._b=n._b,this.setAlpha(n._a),this},lighten:function(){return this._applyModification(f,arguments)},brighten:function(){return this._applyModification(d,arguments)},darken:function(){return this._applyModification(h,arguments)},desaturate:function(){return this._applyModification(l,arguments)},saturate:function(){return this._applyModification(c,arguments)},greyscale:function(){return this._applyModification(u,arguments)},spin:function(){return this._applyModification(p,arguments)},_applyCombination:function(t,e){return t.apply(null,[this].concat([].slice.call(e)))},analogous:function(){return this._applyCombination(y,arguments)},complement:function(){return this._applyCombination(g,arguments)},monochromatic:function(){return this._applyCombination(w,arguments)},splitcomplement:function(){return this._applyCombination(m,arguments)},triad:function(){return this._applyCombination(v,arguments)},tetrad:function(){return this._applyCombination(b,arguments)}},X.fromRatio=function(t,e){if("object"==("undefined"==typeof t?"undefined":_typeof(t))){var n={};for(var r in t)t.hasOwnProperty(r)&&("a"===r?n[r]=t[r]:n[r]=T(t[r]));t=n}return X(t,e)},X.equals=function(t,e){return t&&e?X(t).toRgbString()==X(e).toRgbString():!1},X.random=function(){return X.fromRatio({r:H(),g:H(),b:H()})},X.mix=function(t,e,n){n=0===n?0:n||50;var r,a=X(t).toRgb(),i=X(e).toRgb(),o=n/100,s=2*o-1,l=i.a-a.a;r=s*l==-1?s:(s+l)/(1+s*l),r=(r+1)/2;var c=1-r,u={r:i.r*r+a.r*c,g:i.g*r+a.g*c,b:i.b*r+a.b*c,a:i.a*o+a.a*(1-o)};return X(u)},X.readability=function(t,e){var n=X(t),r=X(e),a=n.toRgb(),i=r.toRgb(),o=n.getBrightness(),s=r.getBrightness(),l=Math.max(a.r,i.r)-Math.min(a.r,i.r)+Math.max(a.g,i.g)-Math.min(a.g,i.g)+Math.max(a.b,i.b)-Math.min(a.b,i.b);return{brightness:Math.abs(o-s),color:l}},X.isReadable=function(t,e){var n=X.readability(t,e);return n.brightness>125&&n.color>500},X.mostReadable=function(t,e){for(var n=null,r=0,a=!1,i=0;i<e.length;i++){var o=X.readability(t,e[i]),s=o.brightness>125&&o.color>500,l=3*(o.brightness/125)+o.color/500;(s&&!a||s&&a&&l>r||!s&&!a&&l>r)&&(a=s,r=l,n=X(e[i]))}return n};var B=X.names={aliceblue:"f0f8ff",antiquewhite:"faebd7",aqua:"0ff",aquamarine:"7fffd4",azure:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"000",blanchedalmond:"ffebcd",blue:"00f",blueviolet:"8a2be2",brown:"a52a2a",burlywood:"deb887",burntsienna:"ea7e5d",cadetblue:"5f9ea0",chartreuse:"7fff00",chocolate:"d2691e",coral:"ff7f50",cornflowerblue:"6495ed",cornsilk:"fff8dc",crimson:"dc143c",cyan:"0ff",darkblue:"00008b",darkcyan:"008b8b",darkgoldenrod:"b8860b",darkgray:"a9a9a9",darkgreen:"006400",darkgrey:"a9a9a9",darkkhaki:"bdb76b",darkmagenta:"8b008b",darkolivegreen:"556b2f",darkorange:"ff8c00",darkorchid:"9932cc",darkred:"8b0000",darksalmon:"e9967a",darkseagreen:"8fbc8f",darkslateblue:"483d8b",darkslategray:"2f4f4f",darkslategrey:"2f4f4f",darkturquoise:"00ced1",darkviolet:"9400d3",deeppink:"ff1493",deepskyblue:"00bfff",dimgray:"696969",dimgrey:"696969",dodgerblue:"1e90ff",firebrick:"b22222",floralwhite:"fffaf0",forestgreen:"228b22",fuchsia:"f0f",gainsboro:"dcdcdc",ghostwhite:"f8f8ff",gold:"ffd700",goldenrod:"daa520",gray:"808080",green:"008000",greenyellow:"adff2f",grey:"808080",honeydew:"f0fff0",hotpink:"ff69b4",indianred:"cd5c5c",indigo:"4b0082",ivory:"fffff0",khaki:"f0e68c",lavender:"e6e6fa",lavenderblush:"fff0f5",lawngreen:"7cfc00",lemonchiffon:"fffacd",lightblue:"add8e6",lightcoral:"f08080",lightcyan:"e0ffff",lightgoldenrodyellow:"fafad2",lightgray:"d3d3d3",lightgreen:"90ee90",lightgrey:"d3d3d3",lightpink:"ffb6c1",lightsalmon:"ffa07a",lightseagreen:"20b2aa",lightskyblue:"87cefa",lightslategray:"789",lightslategrey:"789",lightsteelblue:"b0c4de",lightyellow:"ffffe0",lime:"0f0",limegreen:"32cd32",linen:"faf0e6",magenta:"f0f",maroon:"800000",mediumaquamarine:"66cdaa",mediumblue:"0000cd",mediumorchid:"ba55d3",mediumpurple:"9370db",mediumseagreen:"3cb371",mediumslateblue:"7b68ee",mediumspringgreen:"00fa9a",mediumturquoise:"48d1cc",mediumvioletred:"c71585",midnightblue:"191970",mintcream:"f5fffa",mistyrose:"ffe4e1",moccasin:"ffe4b5",navajowhite:"ffdead",navy:"000080",oldlace:"fdf5e6",olive:"808000",olivedrab:"6b8e23",orange:"ffa500",orangered:"ff4500",orchid:"da70d6",palegoldenrod:"eee8aa",palegreen:"98fb98",paleturquoise:"afeeee",palevioletred:"db7093",papayawhip:"ffefd5",peachpuff:"ffdab9",peru:"cd853f",pink:"ffc0cb",plum:"dda0dd",powderblue:"b0e0e6",purple:"800080",rebeccapurple:"663399",red:"f00",rosybrown:"bc8f8f",royalblue:"4169e1",saddlebrown:"8b4513",salmon:"fa8072",sandybrown:"f4a460",seagreen:"2e8b57",seashell:"fff5ee",sienna:"a0522d",silver:"c0c0c0",skyblue:"87ceeb",slateblue:"6a5acd",slategray:"708090",slategrey:"708090",snow:"fffafa",springgreen:"00ff7f",steelblue:"4682b4",tan:"d2b48c",teal:"008080",thistle:"d8bfd8",tomato:"ff6347",turquoise:"40e0d0",violet:"ee82ee",wheat:"f5deb3",white:"fff",whitesmoke:"f5f5f5",yellow:"ff0",yellowgreen:"9acd32"},L=X.hexNames=_(B),z=function(){var t="[-\\+]?\\d+%?",e="[-\\+]?\\d*\\.\\d+%?",n="(?:"+e+")|(?:"+t+")",r="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?",a="[\\s|\\(]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")[,|\\s]+("+n+")\\s*\\)?";return{rgb:new RegExp("rgb"+r),rgba:new RegExp("rgba"+a),hsl:new RegExp("hsl"+r),hsla:new RegExp("hsla"+a),hsv:new RegExp("hsv"+r),hsva:new RegExp("hsva"+a),hex3:/^([0-9a-fA-F]{1})([0-9a-fA-F]{1})([0-9a-fA-F]{1})$/,hex6:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/,hex8:/^([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/}}();window.tinycolor=X}(),t(function(){t.fn.spectrum.load&&t.fn.spectrum.processNativeColorInputs()})});var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){"use strict";"function"==typeof define&&define.amd?define(t):"undefined"!=typeof module&&"undefined"!=typeof module.exports?module.exports=t():"undefined"!=typeof Package?Sortable=t():window.Sortable=t()}(function(){"use strict";function t(t,e){if(!t||!t.nodeType||1!==t.nodeType)throw"Sortable: `el` must be HTMLElement, and not "+{}.toString.call(t);this.el=t,this.options=e=m({},e),t[I]=this;var n={group:Math.random(),sort:!0,disabled:!1,store:null,handle:null,scroll:!0,scrollSensitivity:30,scrollSpeed:10,draggable:/[uo]l/i.test(t.nodeName)?"li":">*",ghostClass:"sortable-ghost",chosenClass:"sortable-chosen",ignore:"a, img",filter:null,animation:0,setData:function(t,e){t.setData("Text",e.textContent)},dropBubble:!1,dragoverBubble:!1,dataIdAttr:"data-id",delay:0,forceFallback:!1,fallbackClass:"sortable-fallback",fallbackOnBody:!1};for(var r in n)!(r in e)&&(e[r]=n[r]);V(e);for(var i in this)"_"===i.charAt(0)&&(this[i]=this[i].bind(this));this.nativeDraggable=e.forceFallback?!1:B,a(t,"mousedown",this._onTapStart),a(t,"touchstart",this._onTapStart),this.nativeDraggable&&(a(t,"dragover",this),a(t,"dragenter",this)),q.push(this._onDragOver),e.store&&this.sort(e.store.get(this))}function e(t){x&&x.state!==t&&(s(x,"display",t?"none":""),!t&&x.state&&k.insertBefore(x,y),x.state=t)}function n(t,e,n){if(t){n=n||H;do if(">*"===e&&t.parentNode===n||v(t,e))return t;while(t!==n&&(t=t.parentNode))}return null}function r(t){t.dataTransfer&&(t.dataTransfer.dropEffect="move"),t.preventDefault()}function a(t,e,n){t.addEventListener(e,n,!1)}function i(t,e,n){t.removeEventListener(e,n,!1)}function o(t,e,n){if(t)if(t.classList)t.classList[n?"add":"remove"](e);else{var r=(" "+t.className+" ").replace(N," ").replace(" "+e+" "," ");t.className=(r+(n?" "+e:"")).replace(N," ")}}function s(t,e,n){var r=t&&t.style;if(r){if(void 0===n)return H.defaultView&&H.defaultView.getComputedStyle?n=H.defaultView.getComputedStyle(t,""):t.currentStyle&&(n=t.currentStyle),void 0===e?n:n[e];e in r||(e="-webkit-"+e),r[e]=n+("string"==typeof n?"":"px")}}function l(t,e,n){if(t){var r=t.getElementsByTagName(e),a=0,i=r.length;if(n)for(;i>a;a++)n(r[a],a);return r}return[]}function c(t,e,n,r,a,i,o){var s=H.createEvent("Event"),l=(t||e[I]).options,c="on"+n.charAt(0).toUpperCase()+n.substr(1);s.initEvent(n,!0,!0),s.to=e,s.from=a||e,s.item=r||e,s.clone=x,s.oldIndex=i,s.newIndex=o,e.dispatchEvent(s),l[c]&&l[c].call(t,s)}function u(t,e,n,r,a,i){var o,s,l=t[I],c=l.options.onMove;return o=H.createEvent("Event"),o.initEvent("move",!0,!0),o.to=e,o.from=t,o.dragged=n,o.draggedRect=r,o.related=a||e,o.relatedRect=i||e.getBoundingClientRect(),t.dispatchEvent(o),c&&(s=c.call(l,o)),s}function f(t){t.draggable=!1}function d(){z=!1}function h(t,e){var n=t.lastElementChild,r=n.getBoundingClientRect();return(e.clientY-(r.top+r.height)>5||e.clientX-(r.right+r.width)>5)&&n}function p(t){for(var e=t.tagName+t.className+t.src+t.href+t.textContent,n=e.length,r=0;n--;)r+=e.charCodeAt(n);return r.toString(36)}function g(t,e){var n=0;if(!t||!t.parentNode)return-1;for(;t&&(t=t.previousElementSibling);)"TEMPLATE"!==t.nodeName.toUpperCase()&&v(t,e)&&n++;return n}function v(t,e){if(t){e=e.split(".");var n=e.shift().toUpperCase(),r=new RegExp("\\s("+e.join("|")+")(?=\\s)","g");return!(""!==n&&t.nodeName.toUpperCase()!=n||e.length&&((" "+t.className+" ").match(r)||[]).length!=e.length)}return!1}function b(t,e){var n,r;return function(){void 0===n&&(n=arguments,r=this,setTimeout(function(){1===n.length?t.call(r,n[0]):t.apply(r,n),n=void 0},e))}}function m(t,e){if(t&&e)for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}if("undefined"==typeof window||"undefined"==typeof window.document)return function(){throw new Error("Sortable.js requires a window with a document")};var y,w,_,x,k,S,j,A,O,C,T,E,D,$,M,P,F,R={},N=/\s+/g,I="Sortable"+(new Date).getTime(),Y=window,H=Y.document,X=Y.parseInt,B=!!("draggable"in H.createElement("div")),L=function(t){return t=H.createElement("x"),t.style.cssText="pointer-events:auto","auto"===t.style.pointerEvents}(),z=!1,W=Math.abs,q=([].slice,[]),G=b(function(t,e,n){if(n&&e.scroll){var r,a,i,o,s=e.scrollSensitivity,l=e.scrollSpeed,c=t.clientX,u=t.clientY,f=window.innerWidth,d=window.innerHeight;if(A!==n&&(j=e.scroll,A=n,j===!0)){j=n;do if(j.offsetWidth<j.scrollWidth||j.offsetHeight<j.scrollHeight)break;while(j=j.parentNode)}j&&(r=j,a=j.getBoundingClientRect(),i=(W(a.right-c)<=s)-(W(a.left-c)<=s),o=(W(a.bottom-u)<=s)-(W(a.top-u)<=s)),i||o||(i=(s>=f-c)-(s>=c),o=(s>=d-u)-(s>=u),(i||o)&&(r=Y)),(R.vx!==i||R.vy!==o||R.el!==r)&&(R.el=r,R.vx=i,R.vy=o,clearInterval(R.pid),r&&(R.pid=setInterval(function(){r===Y?Y.scrollTo(Y.pageXOffset+i*l,Y.pageYOffset+o*l):(o&&(r.scrollTop+=o*l),i&&(r.scrollLeft+=i*l))},24)))}},30),V=function(t){var e=t.group;e&&"object"==("undefined"==typeof e?"undefined":_typeof(e))||(e=t.group={name:e}),["pull","put"].forEach(function(t){t in e||(e[t]=!0)}),t.groups=" "+e.name+(e.put.join?" "+e.put.join(" "):"")+" "};return t.prototype={constructor:t,_onTapStart:function(t){var e=this,r=this.el,a=this.options,i=t.type,o=t.touches&&t.touches[0],s=(o||t).target,l=s,u=a.filter;if(!("mousedown"===i&&0!==t.button||a.disabled)&&(s=n(s,a.draggable,r))){if(E=g(s,a.draggable),"function"==typeof u){if(u.call(this,t,s,this))return c(e,l,"filter",s,r,E),void t.preventDefault()}else if(u&&(u=u.split(",").some(function(t){return t=n(l,t.trim(),r),t?(c(e,t,"filter",s,r,E),!0):void 0})))return void t.preventDefault();(!a.handle||n(l,a.handle,r))&&this._prepareDragStart(t,o,s)}},_prepareDragStart:function(t,e,n){var r,i=this,s=i.el,c=i.options,u=s.ownerDocument;n&&!y&&n.parentNode===s&&(M=t,k=s,y=n,w=y.parentNode,S=y.nextSibling,$=c.group,r=function(){i._disableDelayedDrag(),y.draggable=!0,o(y,i.options.chosenClass,!0),i._triggerDragStart(e)},c.ignore.split(",").forEach(function(t){l(y,t.trim(),f)}),a(u,"mouseup",i._onDrop),a(u,"touchend",i._onDrop),a(u,"touchcancel",i._onDrop),c.delay?(a(u,"mouseup",i._disableDelayedDrag),a(u,"touchend",i._disableDelayedDrag),a(u,"touchcancel",i._disableDelayedDrag),a(u,"mousemove",i._disableDelayedDrag),a(u,"touchmove",i._disableDelayedDrag),i._dragStartTimer=setTimeout(r,c.delay)):r())},_disableDelayedDrag:function(){var t=this.el.ownerDocument;clearTimeout(this._dragStartTimer),i(t,"mouseup",this._disableDelayedDrag),i(t,"touchend",this._disableDelayedDrag),i(t,"touchcancel",this._disableDelayedDrag),i(t,"mousemove",this._disableDelayedDrag),i(t,"touchmove",this._disableDelayedDrag)},_triggerDragStart:function(t){t?(M={target:y,clientX:t.clientX,clientY:t.clientY},this._onDragStart(M,"touch")):this.nativeDraggable?(a(y,"dragend",this),a(k,"dragstart",this._onDragStart)):this._onDragStart(M,!0);try{H.selection?H.selection.empty():window.getSelection().removeAllRanges()}catch(e){}},_dragStarted:function(){k&&y&&(o(y,this.options.ghostClass,!0),t.active=this,c(this,k,"start",y,k,E))},_emulateDragOver:function(){if(P){if(this._lastX===P.clientX&&this._lastY===P.clientY)return;this._lastX=P.clientX,this._lastY=P.clientY,L||s(_,"display","none");var t=H.elementFromPoint(P.clientX,P.clientY),e=t,n=" "+this.options.group.name,r=q.length;if(e)do{if(e[I]&&e[I].options.groups.indexOf(n)>-1){for(;r--;)q[r]({clientX:P.clientX,clientY:P.clientY,target:t,rootEl:e});break}t=e}while(e=e.parentNode);L||s(_,"display","")}},_onTouchMove:function(e){if(M){t.active||this._dragStarted(),this._appendGhost();var n=e.touches?e.touches[0]:e,r=n.clientX-M.clientX,a=n.clientY-M.clientY,i=e.touches?"translate3d("+r+"px,"+a+"px,0)":"translate("+r+"px,"+a+"px)";F=!0,P=n,s(_,"webkitTransform",i),s(_,"mozTransform",i),s(_,"msTransform",i),s(_,"transform",i),e.preventDefault()}},_appendGhost:function(){if(!_){var t,e=y.getBoundingClientRect(),n=s(y),r=this.options;_=y.cloneNode(!0),o(_,r.ghostClass,!1),o(_,r.fallbackClass,!0),s(_,"top",e.top-X(n.marginTop,10)),s(_,"left",e.left-X(n.marginLeft,10)),s(_,"width",e.width),s(_,"height",e.height),s(_,"opacity","0.8"),s(_,"position","fixed"),s(_,"zIndex","100000"),s(_,"pointerEvents","none"),r.fallbackOnBody&&H.body.appendChild(_)||k.appendChild(_),t=_.getBoundingClientRect(),s(_,"width",2*e.width-t.width),s(_,"height",2*e.height-t.height)}},_onDragStart:function(t,e){var n=t.dataTransfer,r=this.options;this._offUpEvents(),"clone"==$.pull&&(x=y.cloneNode(!0),s(x,"display","none"),k.insertBefore(x,y)),e?("touch"===e?(a(H,"touchmove",this._onTouchMove),a(H,"touchend",this._onDrop),a(H,"touchcancel",this._onDrop)):(a(H,"mousemove",this._onTouchMove),a(H,"mouseup",this._onDrop)),this._loopId=setInterval(this._emulateDragOver,50)):(n&&(n.effectAllowed="move",r.setData&&r.setData.call(this,n,y)),a(H,"drop",this),setTimeout(this._dragStarted,0))},_onDragOver:function(t){var r,a,i,o=this.el,l=this.options,c=l.group,f=c.put,p=$===c,g=l.sort;if(void 0!==t.preventDefault&&(t.preventDefault(),!l.dragoverBubble&&t.stopPropagation()),F=!0,$&&!l.disabled&&(p?g||(i=!k.contains(y)):$.pull&&f&&($.name===c.name||f.indexOf&&~f.indexOf($.name)))&&(void 0===t.rootEl||t.rootEl===this.el)){if(G(t,l,this.el),z)return;if(r=n(t.target,l.draggable,o),a=y.getBoundingClientRect(),i)return e(!0),void(x||S?k.insertBefore(y,x||S):g||k.appendChild(y));if(0===o.children.length||o.children[0]===_||o===t.target&&(r=h(o,t))){if(r){if(r.animated)return;b=r.getBoundingClientRect()}e(p),u(k,o,y,a,r,b)!==!1&&(y.contains(o)||(o.appendChild(y),w=o),this._animate(a,y),r&&this._animate(b,r))}else if(r&&!r.animated&&r!==y&&void 0!==r.parentNode[I]){O!==r&&(O=r,C=s(r),T=s(r.parentNode));var v,b=r.getBoundingClientRect(),m=b.right-b.left,j=b.bottom-b.top,A=/left|right|inline/.test(C.cssFloat+C.display)||"flex"==T.display&&0===T["flex-direction"].indexOf("row"),E=r.offsetWidth>y.offsetWidth,D=r.offsetHeight>y.offsetHeight,M=(A?(t.clientX-b.left)/m:(t.clientY-b.top)/j)>.5,P=r.nextElementSibling,R=u(k,o,y,a,r,b);if(R!==!1){if(z=!0,setTimeout(d,30),e(p),1===R||-1===R)v=1===R;else if(A){var N=y.offsetTop,Y=r.offsetTop;v=N===Y?r.previousElementSibling===y&&!E||M&&E:Y>N}else v=P!==y&&!D||M&&D;y.contains(o)||(v&&!P?o.appendChild(y):r.parentNode.insertBefore(y,v?P:r)),w=y.parentNode,this._animate(a,y),this._animate(b,r)}}}},_animate:function(t,e){var n=this.options.animation;if(n){var r=e.getBoundingClientRect();s(e,"transition","none"),s(e,"transform","translate3d("+(t.left-r.left)+"px,"+(t.top-r.top)+"px,0)"),e.offsetWidth,s(e,"transition","all "+n+"ms"),s(e,"transform","translate3d(0,0,0)"),clearTimeout(e.animated),e.animated=setTimeout(function(){s(e,"transition",""),s(e,"transform",""),e.animated=!1},n)}},_offUpEvents:function(){var t=this.el.ownerDocument;i(H,"touchmove",this._onTouchMove),i(t,"mouseup",this._onDrop),i(t,"touchend",this._onDrop),i(t,"touchcancel",this._onDrop)},_onDrop:function(e){var n=this.el,r=this.options;clearInterval(this._loopId),clearInterval(R.pid),clearTimeout(this._dragStartTimer),i(H,"mousemove",this._onTouchMove),this.nativeDraggable&&(i(H,"drop",this),i(n,"dragstart",this._onDragStart)),this._offUpEvents(),e&&(F&&(e.preventDefault(),!r.dropBubble&&e.stopPropagation()),_&&_.parentNode.removeChild(_),y&&(this.nativeDraggable&&i(y,"dragend",this),f(y),o(y,this.options.ghostClass,!1),o(y,this.options.chosenClass,!1),k!==w?(D=g(y,r.draggable),D>=0&&(c(null,w,"sort",y,k,E,D),c(this,k,"sort",y,k,E,D),c(null,w,"add",y,k,E,D),c(this,k,"remove",y,k,E,D))):(x&&x.parentNode.removeChild(x),y.nextSibling!==S&&(D=g(y,r.draggable),D>=0&&(c(this,k,"update",y,k,E,D),c(this,k,"sort",y,k,E,D)))),t.active&&((null===D||-1===D)&&(D=E),c(this,k,"end",y,k,E,D),this.save()))),this._nulling()},_nulling:function(){k=y=w=_=S=x=j=A=M=P=F=D=O=C=$=t.active=null},handleEvent:function(t){var e=t.type;"dragover"===e||"dragenter"===e?y&&(this._onDragOver(t),r(t)):("drop"===e||"dragend"===e)&&this._onDrop(t)},toArray:function(){for(var t,e=[],r=this.el.children,a=0,i=r.length,o=this.options;i>a;a++)t=r[a],n(t,o.draggable,this.el)&&e.push(t.getAttribute(o.dataIdAttr)||p(t));return e},sort:function(t){var e={},r=this.el;this.toArray().forEach(function(t,a){var i=r.children[a];n(i,this.options.draggable,r)&&(e[t]=i)},this),t.forEach(function(t){e[t]&&(r.removeChild(e[t]),r.appendChild(e[t]))})},save:function(){var t=this.options.store;t&&t.set(this)},closest:function(t,e){return n(t,e||this.options.draggable,this.el)},option:function(t,e){var n=this.options;return void 0===e?n[t]:(n[t]=e,void("group"===t&&V(n)))},destroy:function(){var t=this.el;t[I]=null,i(t,"mousedown",this._onTapStart),i(t,"touchstart",this._onTapStart),this.nativeDraggable&&(i(t,"dragover",this),i(t,"dragenter",this)),Array.prototype.forEach.call(t.querySelectorAll("[draggable]"),function(t){t.removeAttribute("draggable")}),q.splice(q.indexOf(this._onDragOver),1),this._onDrop(),this.el=t=null}},t.utils={on:a,off:i,css:s,find:l,is:function(t,e){return!!n(t,e,t)},extend:m,throttle:b,closest:n,toggleClass:o,index:g},t.create=function(e,n){return new t(e,n)},t.version="1.4.2",t}),function(){
"use strict";function t(t,e){var n=t.srcElement||t.target;if(n.classList.contains(e))return n;for(;n=n.parentNode;)if(n.classList&&n.classList.contains(e))return n;return!1}function e(t){var e=0,n=0;if(!t)var t=window.event;return t.pageX||t.pageY?(e=t.pageX,n=t.pageY):(t.clientX||t.clientY)&&(e=t.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,n=t.clientY+document.body.scrollTop+document.documentElement.scrollTop),{x:e,y:n}}function n(){r(),a(),i(),o()}function r(){document.addEventListener("contextmenu",function(e){f=t(e,_),f?(e.preventDefault(),s(),c(e)):(f=null,l())})}function a(){document.addEventListener("click",function(e){var n=t(e,y);if(n)e.preventDefault(),u(n);else{var r=e.which||e.button;1===r&&l()}})}function i(){window.onkeyup=function(t){27===t.keyCode&&l()}}function o(){window.onresize=function(t){l()}}function s(){1!==k&&(k=1,x.classList.add(w))}function l(){0!==k&&(k=0,x.classList.remove(w))}function c(t){d=e(t),h=d.x,p=d.y,g=x.offsetWidth+4,v=x.offsetHeight+4,b=window.innerWidth,m=window.innerHeight,g>b-h?x.style.left=b-g+"px":x.style.left=h+"px",v>m-p?x.style.top=m-v+"px":x.style.top=p+"px"}function u(t){var e=t.getAttribute("data-action"),n=canvas.getActiveObject();switch(e){case"delete":Artboard.removeObject();break;case"duplicate":Artboard.duplicateObject();break;case"layertop":n.bringToFront(),canvas.renderAll();break;case"layerup":n.bringForward(),canvas.renderAll();break;case"layerdown":n.sendBackwards(),canvas.renderAll();break;case"layerbottom":n.sendToBack();break;case"lock":Artboard.lockObject()}l()}var f,d,h,p,g,v,b,m,y="context-menu__link",w="context-menu--active",_="task",x=document.querySelector("#context-menu"),k=(x.querySelectorAll(".context-menu__item"),0);n()}(),fabric.Object.prototype.link="",fabric.Video=fabric.util.createClass(fabric.Image,{type:"video",initialize:function(t,e){e||(e={}),this.callSuper("initialize",e),console.log("inittt");var n=document.createElement("video");n.loop=!0,n.controls=!0,console.log(n),console.log(t),n.innerHTML='<source src="'+t+'">',this._initElement(n,e),this._initConfig(e),n.play(),fabric.util.requestAnimFrame(function r(){canvas.renderAll(),fabric.util.requestAnimFrame(r)})},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{media:{video:this.media.video},link:this.link})},_render:function(t){this.callSuper("_render",t)}}),fabric.Video.fromURL=function(t,e,n){fabric.util.loadImage(t,function(t){e&&e(new fabric.Video(t,n))},null,n&&n.crossOrigin)},fabric.Video.fromObject=function(t,e){var n=new fabric.Video(t.media.video,{width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY,top:t.top,left:t.left,media:{video:t.media.video}});return bindEvents(n),canvas.setActiveObject(n),logObj(),n},fabric.Slider=fabric.util.createClass(fabric.Rect,{type:"slider",initialize:function(t){t||(t={}),this.callSuper("initialize",t),console.log("inittt")},toObject:function(){return fabric.util.object.extend(this.callSuper("toObject"),{id:this.id,fill:this.fill,slides:this.slides,pattern:this.pattern,patternSourceCanvas:this.patternSourceCanvas})},_render:function(t){this.callSuper("_render",t)}}),fabric.Slider.fromArray=function(t,e,n){new fabric.Image.fromURL(t[0].src,function(r){var a=new fabric.StaticCanvas;console.log(r),r.setHeight(a.height),r.setWidth(a.width),a.setBackgroundImage(r),a.renderAll(),console.log(a.getElement());var i=new fabric.Pattern({source:a.getElement(),repeat:"no-repeat"});e&&e(new fabric.Slider({fill:i,width:r.width,height:r.height,left:n.left,top:n.top,slides:t,id:generator.generate(),pattern:i,patternSourceCanvas:a}))},null,n&&n.crossOrigin)},fabric.Slider.fromObject=function(t,e){new fabric.Image.fromURL(t.slides[0].src,function(n){var r=new fabric.StaticCanvas;n.setHeight(r.height),n.setWidth(r.width),r.setBackgroundImage(n);var a=new fabric.Pattern({source:r.getElement(),repeat:"no-repeat"});console.log(r),e&&e(new fabric.Slider({width:t.width,height:t.height,scaleX:t.scaleX,scaleY:t.scaleY,top:t.top,left:t.left,slides:t.slides,fill:a,id:t.id,pattern:a,patternSourceCanvas:r}))})},fabric.Slider.async=!0;var generator=new IDGenerator,canvas=new fabric.Canvas("c",{selectionColor:"blue",selectionLineWidth:2,width:800,height:600}),grid=50,threshold=.2*grid;canvas.on("object:moving",snapMoveToGrid),canvas.on("object:scaling",snapScaleToGrid),canvas.on("object:moving",fixBoundaries),canvas.on("object:scaling",fixBoundaries);var container=document.getElementById("artboard"),paintArea=document.getElementById("canvas");artboardScale(),$(window).resize(function(){artboardScale()}),$("#canvasWidth").on("change paste keyup",function(){canvas.setWidth($(this).val()),canvas.renderAll(),artboardScale(),$(".sizeTag .tag.width span").html($(this).val())}),$("#canvasHeight").on("change paste keyup",function(){canvas.setHeight($(this).val()),canvas.renderAll(),artboardScale(),$(".sizeTag .tag.height span").html($(this).val())}),$("#canvas-select").change(function(){var t=$("#canvas-select option:selected").attr("data-width"),e=$("#canvas-select option:selected").attr("data-height");$("#widthValue").val(t),$("#heightValue").val(e),canvas.setWidth(t),canvas.setHeight(e),canvas.renderAll(),artboardScale(),$(".sizeTag .tag.width span").html(t),$(".sizeTag .tag.height span").html(e)}),$(".layoutpresets").on("click","a",function(){if(""!=$(this).attr("data-src")||void 0!=$(this).attr("data-src"))if($(this).parent().siblings().children("a").removeClass("active"),$(this).addClass("active"),canvas._objects.length>0){var t=confirm("讀取預設版型會移除目前畫面中的所有物件，是否確定讀取？");if(1!=t)return;Artboard.dispose(),loadPresetsFromJSON($(this).attr("data-src"))}else loadPresetsFromJSON($(this).attr("data-src"));else alert("Error loading preset.")}),$(".tools").on("click","a",function(){var t=$(this).attr("class");switch(t){case"js-add-rect":Artboard.addRect();break;case"js-add-circle":Artboard.addCircle();break;case"js-add-text":Artboard.addText();break;case"js-dispose":Artboard.dispose();break;case"js-setting":$("#canvassetting").fadeTo("fast",.9)}}),$(".objectControl").on("click","button",function(){var t=$(this).attr("class");switch(t){case"js-delete":Artboard.removeObject();break;case"js-reset":Artboard.reset()}}),$(".objectSize").on("change",function(){var t,e,n,r,a=canvas.getActiveObject();t=a.width,e=a.height,n=$("#objectWidth").val()/t,r=$("#objectHeight").val()/e,a.setScaleX(n),a.setScaleY(r),a.setCoords(),canvas.renderAll(),logObj()}),$("#objectColor").spectrum({showInput:!0,className:"full-spectrum",showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxSelectionSize:10,preferredFormat:"hex",localStorageKey:"spectrum.demo",move:function(t){},show:function(){},beforeShow:function(){},hide:function(){},change:function(t){var e=canvas.getActiveObject();"i-text"===e.type?(e.setTextBackgroundColor(t),console.log(t)):e.setFill(t),canvas.renderAll(),logObj(),$("#objectColor").spectrum("hide")},palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]}),$("#objectTextColor").spectrum({showInput:!0,className:"full-spectrum",showInitial:!0,showPalette:!0,showSelectionPalette:!0,maxSelectionSize:10,preferredFormat:"hex",localStorageKey:"spectrum.demo",move:function(t){},show:function(){},beforeShow:function(){},hide:function(){},change:function(t){var e=canvas.getActiveObject();"i-text"===e.type&&e.setFill(t),canvas.renderAll(),logObj(),$("#objectTextColor").spectrum("hide")},palette:[["rgb(0, 0, 0)","rgb(67, 67, 67)","rgb(102, 102, 102)","rgb(204, 204, 204)","rgb(217, 217, 217)","rgb(255, 255, 255)"],["rgb(152, 0, 0)","rgb(255, 0, 0)","rgb(255, 153, 0)","rgb(255, 255, 0)","rgb(0, 255, 0)","rgb(0, 255, 255)","rgb(74, 134, 232)","rgb(0, 0, 255)","rgb(153, 0, 255)","rgb(255, 0, 255)"],["rgb(230, 184, 175)","rgb(244, 204, 204)","rgb(252, 229, 205)","rgb(255, 242, 204)","rgb(217, 234, 211)","rgb(208, 224, 227)","rgb(201, 218, 248)","rgb(207, 226, 243)","rgb(217, 210, 233)","rgb(234, 209, 220)","rgb(221, 126, 107)","rgb(234, 153, 153)","rgb(249, 203, 156)","rgb(255, 229, 153)","rgb(182, 215, 168)","rgb(162, 196, 201)","rgb(164, 194, 244)","rgb(159, 197, 232)","rgb(180, 167, 214)","rgb(213, 166, 189)","rgb(204, 65, 37)","rgb(224, 102, 102)","rgb(246, 178, 107)","rgb(255, 217, 102)","rgb(147, 196, 125)","rgb(118, 165, 175)","rgb(109, 158, 235)","rgb(111, 168, 220)","rgb(142, 124, 195)","rgb(194, 123, 160)","rgb(166, 28, 0)","rgb(204, 0, 0)","rgb(230, 145, 56)","rgb(241, 194, 50)","rgb(106, 168, 79)","rgb(69, 129, 142)","rgb(60, 120, 216)","rgb(61, 133, 198)","rgb(103, 78, 167)","rgb(166, 77, 121)","rgb(91, 15, 0)","rgb(102, 0, 0)","rgb(120, 63, 4)","rgb(127, 96, 0)","rgb(39, 78, 19)","rgb(12, 52, 61)","rgb(28, 69, 135)","rgb(7, 55, 99)","rgb(32, 18, 77)","rgb(76, 17, 48)"]]}),$("#objectInput").on("keydown keyup paste change",function(){var t=canvas.getActiveObject();t.set("text",$(this).val()),t.setCoords(),canvas.renderAll()}),$("#objectFontFamily").on("change",function(){var t=$(this).val(),e=canvas.getActiveObject();e.setFontFamily(t),e.setCoords(),canvas.renderAll()}),$("#objectFontSize").on("change",function(){var t=$(this).val(),e=canvas.getActiveObject();e.setFontSize(t),e.setCoords(),canvas.renderAll()}),$("#linkValue").on("keydown keyup change",function(){var t=canvas.getActiveObject(),e=$(this).val();t.set("link",e),logObj()}),$(".js-library").on("click",function(){$("#mediaLibrary").addClass("active"),$("#mediaLibrary .selection").empty(),$("#mediaLibrary .resources a").removeClass("active")}),$("#mediaLibrary .js-close").on("click",function(){$("#mediaLibrary").removeClass("active")}),$("#mediaLibrary .resources").on("click","a",function(){var t,e,n,r,a=$(".settings-container .selection");e=$(this).attr("data-src"),t=$(this).find(".filename").html(),r=$(this).attr("data-resourceid"),n="1";var i="<li data-resourceid="+r+" data-src="+e+"><div class='order'><div class='continued'><input type='number' value='"+n+"'></div></div><div class='description'><div class='filename'>"+t+"</div></div></li>",o=$(this);o.hasClass("active")?a.children("li").each(function(){r===$(this).attr("data-resourceid")&&($(this).remove(),o.removeClass("active"))}):(a.append(i),o.addClass("active"))}),$(".js-sendToObj").on("click",function(){var t,e,n,r=[],a=$(".settings-container .selection");a.children("li").each(function(){t=$(this).attr("data-resourceid"),e=$(this).attr("data-src"),n=$(this).find("input").val();var a={id:t,src:e,continued:n};r.push(a),console.log(r)}),selectionConfirmator(r)});var map={8:!1,91:!1,187:!1,189:!1,40:!1,38:!1,68:!1,17:!1,76:!1};$(document).keydown(function(t){if(t.keyCode in map)if(map[t.keyCode]=!0,map[8]&&map[91])t.preventDefault(),t.stopPropagation(),Artboard.removeObject(),map[8]=!1;else if(map[38]&&map[91]){t.preventDefault(),t.stopPropagation();var e=canvas.getActiveObject();e.bringToFront(),map[38]=!1}else if(map[187]&&map[91]){t.preventDefault(),t.stopPropagation();var e=canvas.getActiveObject();e.bringForward(),map[187]=!1}else if(map[189]&&map[91]){t.preventDefault(),t.stopPropagation();var e=canvas.getActiveObject();e.sendBackwards(),map[189]=!1}else if(map[40]&&map[91]){t.preventDefault(),t.stopPropagation();var e=canvas.getActiveObject();e.sendToBack(),map[40]=!1}else map[68]&&map[17]?(t.preventDefault(),t.stopPropagation(),Artboard.duplicateObject(),map[68]=!1):map[76]&&map[91]&&(t.preventDefault(),t.stopPropagation(),Artboard.lockObject(),map[76]=!1)}).keyup(function(t){t.keyCode in map&&(map[t.keyCode]=!1)});var instantMeta={log:function(t){console.log(t.toObject()),console.log(t),t=t.toObject();var e,n,r,a,i,o,s,l,c,u,f,d,h,p,g,v;switch(e=t.width*t.scaleX,n=t.height*t.scaleY,r=t.scaleX,a=t.scaleY,i=t.radius,o=t.left,s=t.top,l=t.angle,c=t.type,v=t.link,f="i-text"===t.type?t.textBackgroundColor:t.fill,d=t.fill,h=t.text,p=t.fontSize,g=t.fontFamily,c){case"image":u=t.src;break;case"video":u=t.media.video;break;case"slider":u="mixture"}$(".attributes-wrapper .type input").val(c),$(".attributes-wrapper .width input").val(e),$(".attributes-wrapper .height input").val(n),$(".attributes-wrapper .radius input").val(i),$(".attributes-wrapper .angle input").val(l),$(".attributes-wrapper .top input").val(s),$(".attributes-wrapper .left input").val(o),$(".attributes-wrapper .media input").val(u),$(".attributes-wrapper .scalex input").val(r),$(".attributes-wrapper .scaley input").val(a),$(".attributes-wrapper .text input").val(h),$(".attributes-wrapper .link input").val(v),$(".attributes-wrapper .fontsize select option[value="+p+"]").attr("selected",!0),$('.attributes-wrapper .fontfamily select option[value="'+g+'"]').attr("selected",!0),$("#objectColor").spectrum("set",f),$("#objectTextColor").spectrum("set",d),logObj()},clean:function(t){$(".attributes-wrapper input").val(""),$(".attributes-wrapper .mediaPreview").empty(),console.log("clean")}},initRadius=100,Artboard=function(){return{addRect:function(){var t=new fabric.Rect({left:canvas.getWidth()/2-initRadius/2,top:canvas.getHeight()/2-initRadius/2,fill:"#"+Math.floor(16777215*Math.random()).toString(16),width:initRadius,height:initRadius});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),t.perPixelTargetFind=!0,canvas.add(t),bindEvents(t),canvas.setActiveObject(t),logObj()},addCircle:function(){var t=new fabric.Circle({left:canvas.getWidth()/2-initRadius/2,top:canvas.getHeight()/2-initRadius/2,fill:"#"+Math.floor(16777215*Math.random()).toString(16),radius:initRadius/2});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),t.perPixelTargetFind=!0,canvas.add(t),bindEvents(t),canvas.setActiveObject(t),logObj()},addText:function(){var t=new fabric.IText("test",{left:200,top:200,lockScalingX:!0,lockScalingY:!0,fontSize:"36"});t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),canvas.add(t),bindEvents(t),canvas.setActiveObject(t),logObj()},addMedia:function(t){if(t.length>1){var e=t;Multimedia.slider(e)}else if(1===t.length){var n=t[0].src.split(".").pop(),r=validateYouTubeUrl(t[0].src);if(0!=r){getThumbnails(r,function(t){console.log(t),Multimedia.video(t,r)})}else n.match(/^(gif|png|jpg|jpeg|tiff|svg)$/)?Multimedia.image(t[0].src):n.match(/^(mp4|avi|ogg|ogv|webm)$/)?Multimedia.video(t[0].src):console.log("不支援此檔案格式，請重試")}},dispose:function(){for(var t=0;t<canvas._objects.length;t++)void 0!==canvas._objects[t]._element&&"video"===canvas._objects[t]._element.localName?canvas._objects[t].getElement().pause():console.log("error");canvas.clear(),logObj()},duplicateObject:function(){var t=canvas.getActiveObject();canvas.add(t.clone()),canvas.renderAll()},lockObject:function(){var t=canvas.getActiveObject();t.lockMovementY===!0?(t.lockMovementY=!1,t.lockMovementX=!1,t.lockRotation=!1,t.lockScalingX=!1,t.lockScalingY=!1):(t.lockMovementY=!0,t.lockMovementX=!0,t.lockRotation=!0,t.lockScalingX=!0,t.lockScalingY=!0)},removeObject:function(){var t=canvas.getActiveObject();void 0!==t._element&&"video"===t._element.localName?(t.getElement().pause(),t.remove()):t.remove()},reset:function(){var t=canvas.getActiveObject();t.setScaleX("1"),t.setScaleY("1"),t.center(),t.setCoords(),canvas.renderAll(),instantMeta.log(t)}}}(),Multimedia=function(){return{image:function(t){new fabric.Image.fromURL(t,function(t){t.set({left:canvas.getWidth()/2-t.width/2,top:canvas.getHeight()/2-t.height/2}),canvas.add(t),t.center(),t.setCoords(),t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(t.toObject),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t),logObj()})},video:function t(e,n){if(void 0!=n){console.log(e);var r=new fabric.Video.fromURL(e,function(t){t.set({left:canvas.getWidth()/2-t.width/2,top:canvas.getHeight()/2-t.height/2}),r.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{link:this.link})}}(r.toObject),canvas.add(t),t.center(),t.setCoords(),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t),logObj()})}else{console.log("match video");var a,i,t=new fabric.Video(e,{media:{video:e}}),o=t.getElement();canvas.add(t),console.log(o),console.log(t),o.onloadeddata=function(){a=this.videoWidth,i=this.videoHeight,t.setWidth(a),t.setHeight(i),t.center(),t.setCoords(),canvas.renderAll(),console.log(this),console.log(a),t.getElement().play(),t.toObject=function(t){return function(){return fabric.util.object.extend(t.call(this),{media:{video:e},link:this.link})}}(t.toObject),bindEvents(t),canvas.setActiveObject(t),logObj(),fabric.util.requestAnimFrame(function n(){canvas.renderAll(),fabric.util.requestAnimFrame(n)})}}},slider:function(t){var e,n,r=0;new fabric.Slider.fromArray(t,function(t){function a(t,r,s){t++,t===r.slides.length&&(t=0),n=findObj(s),new fabric.Image.fromURL(r.slides[t].src,function(t){t.setHeight(i.height),t.setWidth(i.width),i.setBackgroundImage(t),i.renderAll(),console.log(i.getElement()),o=new fabric.Pattern({source:i.getElement(),repeat:"no-repeat"}),r.setFill(o),canvas.renderAll()}),e=1e3*r.slides[t].continued,setTimeout(function(){a(t,r,s)},e)}var i=t.patternSourceCanvas,o=t.pattern;console.log(t),console.log(t.toObject()),canvas.add(t),canvas.renderAll(),bindEvents(t),canvas.setActiveObject(t),t.setCoords(),logObj(),e=1e3*t.slides[0].continued;var s=t.id;setTimeout(function(){a(r,t,s)},e)},{left:150,top:100})},clock:function(){},iframe:function(){}}}(),el=document.getElementById("selectionOrder"),sortable=Sortable.create(el),Typekit;!function(t){var e,n={kitId:"daf4cqp",scriptTimeout:3e3,async:!0},r=t.documentElement,a=setTimeout(function(){r.className=r.className.replace(/\bwf-loading\b/g,"")+" wf-inactive"},n.scriptTimeout),i=t.createElement("script"),o=!1,s=t.getElementsByTagName("script")[0];r.className+=" wf-loading",i.src="https://use.typekit.net/"+n.kitId+".js",i.async=!0,i.onload=i.onreadystatechange=function(){if(e=this.readyState,!(o||e&&"complete"!=e&&"loaded"!=e)){o=!0,clearTimeout(a);try{Typekit.load(n)}catch(t){}}},s.parentNode.insertBefore(i,s)}(document);